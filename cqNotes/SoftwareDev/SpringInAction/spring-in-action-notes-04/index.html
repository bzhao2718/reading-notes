<!DOCTYPE html><html class="hide-aside" lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Spring In Action Notes (4) | ReadingNotes</title><meta name="keywords" content="software_dev,spring"><meta name="author"><meta name="copyright"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Ch7 Creating REST Services  Defining REST endpoints in Spring MVC Enabling hyperlinked REST resources Automatic repository-based REST endpoints  Writing RESTful controllers  Retrieving data from the s">
<meta property="og:type" content="article">
<meta property="og:title" content="Spring In Action Notes (4)">
<meta property="og:url" content="https://bzhao2718.github.io/reading-notes/cqNotes/SoftwareDev/SpringInAction/spring-in-action-notes-04/index.html">
<meta property="og:site_name" content="ReadingNotes">
<meta property="og:description" content="Ch7 Creating REST Services  Defining REST endpoints in Spring MVC Enabling hyperlinked REST resources Automatic repository-based REST endpoints  Writing RESTful controllers  Retrieving data from the s">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.pixabay.com/photo/2012/10/29/15/38/binary-code-63529_1280.jpg">
<meta property="article:published_time" content="2021-10-28T23:21:53.000Z">
<meta property="article:modified_time" content="2021-11-25T19:02:41.925Z">
<meta property="article:tag" content="software_dev">
<meta property="article:tag" content="spring">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.pixabay.com/photo/2012/10/29/15/38/binary-code-63529_1280.jpg"><link rel="shortcut icon" href="/reading-notes/img/favicon.png"><link rel="canonical" href="https://bzhao2718.github.io/reading-notes/cqNotes/SoftwareDev/SpringInAction/spring-in-action-notes-04/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/reading-notes/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/reading-notes/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":500},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Spring In Action Notes (4)',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-11-25 13:02:41'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.min.css" media="defer" onload="this.media='all'"><script async src="https://cdn.jsdelivr.net/npm/hexo-butterfly-tag-plugins-plus@latest/lib/carousel-touch.min.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/reading-notes/archives/"><div class="headline">Articles</div><div class="length-num">38</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/reading-notes/tags/"><div class="headline">Tags</div><div class="length-num">10</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/reading-notes/categories/"><div class="headline">Categories</div><div class="length-num">6</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/reading-notes/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/reading-notes/">ReadingNotes</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/reading-notes/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">Spring In Action Notes (4)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2021-10-28T23:21:53.000Z" title="Created 2021-10-28 18:21:53">2021-10-28</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2021-11-25T19:02:41.925Z" title="Updated 2021-11-25 13:02:41">2021-11-25</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/reading-notes/categories/SoftwareDev/">SoftwareDev</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>23min</span></span></div></div></div><article class="post-content" id="article-container"><h1 id="ch7-creating-rest-services">Ch7 Creating REST Services</h1>
<ul>
<li>Defining REST endpoints in Spring MVC</li>
<li>Enabling hyperlinked REST resources</li>
<li>Automatic repository-based REST endpoints</li>
</ul>
<h2 id="writing-restful-controllers">Writing RESTful controllers</h2>
<img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/reading-notes/cqNotes/SoftwareDev/SpringInAction/spring-in-action-notes-04/ch7-rest-methods.png" class="" title="Spring MVC’s HTTP request-handling annotations">
<h3 id="retrieving-data-from-the-server">Retrieving data from the server</h3>
<p><code>DesignTacoController.java</code></p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(path="/design", produces="application/json")</span> <span class="comment">//handle requests for /design</span></span><br><span class="line"><span class="meta">@CrossOrigin(origins="*")</span>        </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DesignTacoController</span> </span>{</span><br><span class="line">  <span class="keyword">private</span> TacoRepository tacoRepo;</span><br><span class="line">  </span><br><span class="line"><span class="comment">//end::recents[]</span></span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  EntityLinks entityLinks;</span><br><span class="line"><span class="comment">//tag::recents[]</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">DesignTacoController</span><span class="params">(TacoRepository tacoRepo)</span> </span>{</span><br><span class="line">    <span class="keyword">this</span>.tacoRepo = tacoRepo;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="meta">@GetMapping("/recent")</span> <span class="comment">//Fetches and returns recent taco designs</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Iterable&lt;Taco&gt; <span class="title">recentTacos</span><span class="params">()</span> </span>{                 </span><br><span class="line">    PageRequest page = PageRequest.of(</span><br><span class="line">            <span class="number">0</span>, <span class="number">12</span>, Sort.by(<span class="string">"createdAt"</span>).descending());</span><br><span class="line">    <span class="keyword">return</span> tacoRepo.findAll(page).getContent();</span><br><span class="line">  }</span><br><span class="line">  <span class="comment">//end::recents[]</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  //tag::recentsHateoas1[]</span></span><br><span class="line"><span class="comment">  @GetMapping("/recent")</span></span><br><span class="line"><span class="comment">  public CollectionModel&lt;EntityModel&lt;Taco&gt;&gt; recentTacos() {</span></span><br><span class="line"><span class="comment">    PageRequest page = PageRequest.of(</span></span><br><span class="line"><span class="comment">            0, 12, Sort.by("createdAt").descending());</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    List&lt;Taco&gt; tacos = tacoRepo.findAll(page).getContent();</span></span><br><span class="line"><span class="comment">    CollectionModel&lt;EntityModel&lt;Taco&gt;&gt; recentResources = </span></span><br><span class="line"><span class="comment">    	CollectionModel.wrap(tacos);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    recentResources.add(</span></span><br><span class="line"><span class="comment">        new Link("http://localhost:8080/design/recent", "recents"));</span></span><br><span class="line"><span class="comment">    return recentResources;</span></span><br><span class="line"><span class="comment">  }</span></span><br><span class="line"><span class="comment">  //end::recentsHateoas1[]</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  @GetMapping("/recent")</span></span><br><span class="line"><span class="comment">  public CollectionModel&lt;EntityModel&lt;Taco&gt;&gt; recentTacos() {</span></span><br><span class="line"><span class="comment">    PageRequest page = PageRequest.of(</span></span><br><span class="line"><span class="comment">            0, 12, Sort.by("createdAt").descending());</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    List&lt;Taco&gt; tacos = tacoRepo.findAll(page).getContent();</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  	//tag::recentsHateoas2[]</span></span><br><span class="line"><span class="comment">    CollectionModel&lt;EntityModel&lt;Taco&gt;&gt; recentResources = CollectionModel.wrap(tacos);</span></span><br><span class="line"><span class="comment">    recentResources.add(</span></span><br><span class="line"><span class="comment">        WebMvcLinkBuilder.linkTo(DesignTacoController.class)</span></span><br><span class="line"><span class="comment">    					 .slash("recent")</span></span><br><span class="line"><span class="comment">    					 .withRel("recents"));</span></span><br><span class="line"><span class="comment">	//end::recentsHateoas2[]</span></span><br><span class="line"><span class="comment">    return recentResources;</span></span><br><span class="line"><span class="comment">  }</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  @GetMapping("/recent")</span></span><br><span class="line"><span class="comment">  public CollectionModel&lt;EntityModel&lt;Taco&gt;&gt; recentTacos() {</span></span><br><span class="line"><span class="comment">    PageRequest page = PageRequest.of(</span></span><br><span class="line"><span class="comment">            0, 12, Sort.by("createdAt").descending());</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    List&lt;Taco&gt; tacos = tacoRepo.findAll(page).getContent();</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  	//tag::recentsHateoas3[]</span></span><br><span class="line"><span class="comment">    CollectionModel&lt;EntityModel&lt;Taco&gt;&gt; recentResources = CollectionModel.wrap(tacos);</span></span><br><span class="line"><span class="comment">    recentResources.add(</span></span><br><span class="line"><span class="comment">        linkTo(methodOn(DesignTacoController.class).recentTacos())</span></span><br><span class="line"><span class="comment">			 .withRel("recents"));</span></span><br><span class="line"><span class="comment">	//end::recentsHateoas3[]</span></span><br><span class="line"><span class="comment">    return recentResources;</span></span><br><span class="line"><span class="comment">  }</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">   </span><br><span class="line"></span><br><span class="line"><span class="comment">//  @GetMapping("/recenth")</span></span><br><span class="line"><span class="comment">//  public Resources&lt;TacoResource&gt; recentTacosH() {</span></span><br><span class="line"><span class="comment">//    PageRequest page = PageRequest.of(</span></span><br><span class="line"><span class="comment">//            0, 12, Sort.by("createdAt").descending());</span></span><br><span class="line"><span class="comment">//    List&lt;Taco&gt; tacos = tacoRepo.findAll(page).getContent();</span></span><br><span class="line"><span class="comment">//    </span></span><br><span class="line"><span class="comment">//    List&lt;TacoResource&gt; tacoResources = </span></span><br><span class="line"><span class="comment">//        new TacoResourceAssembler().toResources(tacos);</span></span><br><span class="line"><span class="comment">//    Resources&lt;TacoResource&gt; recentResources = </span></span><br><span class="line"><span class="comment">//        new Resources&lt;TacoResource&gt;(tacoResources);</span></span><br><span class="line"><span class="comment">//    recentResources.add(</span></span><br><span class="line"><span class="comment">//        linkTo(methodOn(DesignTacoController.class).recentTacos())</span></span><br><span class="line"><span class="comment">//        .withRel("recents"));</span></span><br><span class="line"><span class="comment">//    return recentResources;</span></span><br><span class="line"><span class="comment">//  }</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//ControllerLinkBuilder.linkTo(DesignTacoController.class)</span></span><br><span class="line"><span class="comment">//.slash("recent")</span></span><br><span class="line"><span class="comment">//.withRel("recents"));</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//  @GetMapping("/recenth")</span></span><br><span class="line"><span class="comment">//  public Resources&lt;TacoResource&gt; recenthTacos() {</span></span><br><span class="line"><span class="comment">//    PageRequest page = PageRequest.of(</span></span><br><span class="line"><span class="comment">//            0, 12, Sort.by("createdAt").descending());</span></span><br><span class="line"><span class="comment">//    List&lt;Taco&gt; tacos = tacoRepo.findAll(page).getContent();</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//    List&lt;TacoResource&gt; tacoResources = new TacoResourceAssembler().toResources(tacos);</span></span><br><span class="line"><span class="comment">//    </span></span><br><span class="line"><span class="comment">//    Resources&lt;TacoResource&gt; tacosResources = new Resources&lt;&gt;(tacoResources);</span></span><br><span class="line"><span class="comment">////    Link recentsLink = ControllerLinkBuilder</span></span><br><span class="line"><span class="comment">////        .linkTo(DesignTacoController.class)</span></span><br><span class="line"><span class="comment">////        .slash("recent")</span></span><br><span class="line"><span class="comment">////        .withRel("recents");</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//    Link recentsLink = </span></span><br><span class="line"><span class="comment">//        linkTo(methodOn(DesignTacoController.class).recentTacos())</span></span><br><span class="line"><span class="comment">//        .withRel("recents");</span></span><br><span class="line"><span class="comment">//    tacosResources.add(recentsLink);</span></span><br><span class="line"><span class="comment">//    return tacosResources;</span></span><br><span class="line"><span class="comment">//  }</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">//tag::postTaco[]</span></span><br><span class="line">  <span class="meta">@PostMapping(consumes="application/json")</span></span><br><span class="line">  <span class="meta">@ResponseStatus(HttpStatus.CREATED)</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Taco <span class="title">postTaco</span><span class="params">(<span class="meta">@RequestBody</span> Taco taco)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> tacoRepo.save(taco);</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//tag::tacoByIdSimple[]</span></span><br><span class="line">  <span class="meta">@GetMapping("/{id}")</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Taco <span class="title">tacoById</span><span class="params">(<span class="meta">@PathVariable("id")</span> Long id)</span> </span>{</span><br><span class="line">    Optional&lt;Taco&gt; optTaco = tacoRepo.findById(id);</span><br><span class="line">    <span class="keyword">if</span> (optTaco.isPresent()) {</span><br><span class="line">      <span class="keyword">return</span> optTaco.get();</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  }</span><br><span class="line">  <span class="comment">//or use the following to include HTTP status</span></span><br><span class="line">  <span class="meta">@GetMapping("/{id}")</span> </span><br><span class="line">  <span class="function"><span class="keyword">public</span> ResponseEntity&lt;Taco&gt; <span class="title">tacoById</span><span class="params">(<span class="meta">@PathVariable("id")</span> Long id)</span> </span>{</span><br><span class="line">    Optional&lt;Taco&gt; optTaco = tacoRepo.findById(id);</span><br><span class="line">    <span class="keyword">if</span> (optTaco.isPresent()) { </span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity&lt;&gt;(optTaco.get(), HttpStatus.OK); </span><br><span class="line">    } </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity&lt;&gt;(<span class="keyword">null</span>, HttpStatus.NOT_FOUND);</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>The <code>@RestController</code> annotation serves two purposes. First, it’s a stereotype annotation like <code>@Controller</code> and <code>@Service</code> that marks a class for discovery by component scanning. But most relevant to the discussion of REST, the <code>@RestController</code> annotation tells Spring that all handler methods in the controller should have their return value written directly to the body of the response, rather than being carried in the model to a view for rendering.</p>
<p>Alternatively, you could have annotated <code>DesignTacoController</code> with <code>@Controller</code>, just like with any Spring MVC controller. But then you’d need to also annotate all of the handler methods with <code>@ResponseBody</code> to achieve the same result. Yet another option would be to return a <code>ResponseEntity</code> object, which we’ll discuss in a moment.</p>
<p>You’ll notice that the <code>@RequestMapping</code>annotation also sets a produces attribute. This specifies that any of the handler methods in <code>DesignTacoController</code> will only handle requests if the request’s Accept header includes “<code>application/json</code>”. Not only does this limit your API to only producing JSON results, it also allows for another controller (perhaps the <code>DesignTacoController</code> from chapter 2) to handle requests with the same paths, so long as those requests don’t require JSON output.</p>
<p>Because the Angular portion of the application will be running on a separate host and/or port from the API (at least for now), the web browser will prevent your Angular client from consuming the API. This restriction can be overcome by including CORS (Cross-Origin Resource Sharing) headers in the server responses. Spring makes it easy to apply CORS with the <code>@CrossOrigin</code> annotation. As applied here, <code>@CrossOrigin</code> allows clients from any domain to consume the API.</p>
<p>It constructs a <code>PageRequest</code> object that specifies that you only want the first (0th) page of 12 results, sorted in descending order by the taco’s creation date.</p>
<p>Because the controller’s base path is <code>/design</code>, this controller method handles GET requests for <code>/design/{id}</code>, where the <code>{id}</code> portion of the path is a placeholder. The actual value in the request is given to the id parameter, which is mapped to the <code>{id}</code> placeholder by <code>@PathVariable</code>.</p>
<p>Inside of <code>tacoById()</code>, the <code>id</code> parameter is passed to the repository’s <code>findById()</code> method to fetch the <code>Taco</code>. <code>findById()</code>returns an <code>Optional&lt;Taco&gt;</code> because there may not be a taco with the given ID. Therefore, you need to determine whether the ID matched a taco or not before returning a value. If it matches, you call <code>get()</code> on the <code>Optional&lt;Taco&gt;</code> object to return the actual <code>Taco</code>.</p>
<h3 id="sending-data-to-the-server">Sending data to the server</h3>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(consumes="application/json")</span></span><br><span class="line"><span class="meta">@ResponseStatus(HttpStatus.CREATED)</span> </span><br><span class="line"><span class="function"><span class="keyword">public</span> Taco <span class="title">postTaco</span><span class="params">(<span class="meta">@RequestBody</span> Taco taco)</span> </span>{ </span><br><span class="line">  <span class="keyword">return</span> tacoRepo.save(taco); </span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>You’re not specifying a path attribute here, so the <code>postTaco()</code> method will handle requests for <code>/design</code> as specified in the class-level <code>@RequestMapping</code> on <code>DesignTacoController</code>.</p>
<p>The <code>Taco</code> parameter to the method is annotated with <code>@RequestBody</code> to indicate that the body of the request should be converted to a <code>Taco</code> object and bound to the parameter.</p>
<p>This annotation is important—without it, Spring MVC would assume that you want request parameters (either query parameters or form parameters) to be bound to the <code>Taco</code> object. But the <code>@RequestBody</code>annotation ensures that JSON in the request body is bound to the <code>Taco</code> object instead.</p>
<p>Although you’ve used <code>@PostMapping</code> to create a new Taco resource, POST requests can also be used to update resources. Even so, POST requests are typically used for resource creation and PUT and PATCH requests are used to update resources.</p>
<h3 id="updating-data-on-the-server">Updating data on the server</h3>
<p>Although it’s true that PUT is often used to update resource data, it’s actually the semantic opposite of GET. Whereas GET requests are for transferring data from the server to the client, PUT requests are for sending data from the client to the server.</p>
<p>In that sense, PUT is really intended to perform a wholesale replacement operation rather than an update operation. In contrast, the purpose of HTTP PATCH is to perform a patch or partial update of resource data.</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PutMapping(path="/{orderId}", consumes="application/json")</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Order <span class="title">putOrder</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">                      <span class="meta">@PathVariable("orderId")</span> Long orderId,</span></span></span><br><span class="line"><span class="params"><span class="function">                      <span class="meta">@RequestBody</span> Order order)</span> </span>{</span><br><span class="line">  order.setId(orderId);</span><br><span class="line">  <span class="keyword">return</span> repo.save(order);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>THis could work, but it would require that the client submit the complete order data in the PUT request. Semantically, PUT means “put this data this URL”, essentially replacing any data that’s already there. If any of the order’s properties are omitted, that property’s value would be vorewritten with <code>null</code>.</p>
<p>If PUT does a wholesale replacement of the resource data, then how should you handle requests to do just a partial update? That’s what HTTP PATCH requests and Spring’s <code>@PatchMapping</code> are good for.</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PatchMapping(path="/{orderId}", consumes="application/json")</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Order <span class="title">patchOrder</span><span class="params">(<span class="meta">@PathVariable("orderId")</span> Long orderId,</span></span></span><br><span class="line"><span class="params"><span class="function">                        <span class="meta">@RequestBody</span> Order patch)</span> </span>{</span><br><span class="line"></span><br><span class="line">  Order order = repo.findById(orderId).get();</span><br><span class="line">  <span class="keyword">if</span> (patch.getDeliveryName() != <span class="keyword">null</span>) {</span><br><span class="line">    order.setDeliveryName(patch.getDeliveryName());</span><br><span class="line">  }</span><br><span class="line">  ...</span><br><span class="line">  <span class="keyword">if</span> (patch.getCcExpiration() != <span class="keyword">null</span>) {</span><br><span class="line">    order.setCcExpiration(patch.getCcExpiration());</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">if</span> (patch.getCcCVV() != <span class="keyword">null</span>) {</span><br><span class="line">    order.setCcCVV(patch.getCcCVV());</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> repo.save(order);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="deleting-data-from-the-server">Deleting data from the server</h3>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@DeleteMapping("/{orderId}")</span></span><br><span class="line"><span class="meta">@ResponseStatus(HttpStatus.NO_CONTENT)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteOrder</span><span class="params">(<span class="meta">@PathVariable("orderId")</span> Long orderId)</span> </span>{</span><br><span class="line">  <span class="keyword">try</span> {</span><br><span class="line">    repo.deleteById(orderId);</span><br><span class="line">  } <span class="keyword">catch</span> (EmptyResultDataAccessException e) {}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>You’ve already seen <code>@GetMapping</code>,<code>@PostMapping</code>, <code>@PutMapping</code>, and <code>@PatchMapping</code>—each specifying that a method should handle requests for their corresponding HTTP methods. It will probably come as no surprise to you that <code>@DeleteMapping</code> is used to specify that the <code>deleteOrder()</code> method is responsible for handling <code>DELETE</code> requests for <code>/orders/{orderId}</code>.</p>
<p>In this case, it takes the order ID, provided as a path variable in the URL, and passes it to the repository’s <code>deleteById()</code>method. If the order exists when that method is called, it will be deleted. If the order doesn’t exist, an <code>EmptyResultDataAccessException</code> will be thrown.</p>
<h2 id="enabling-hypermedia">Enabling hypermedia</h2>
<p>Using hardcoded URL patterns and string manipulation is common among API client code. But imagine for a moment what would happen if the API’s URL scheme were to change.</p>
<p><em>Hypermedia as the Engine of Application State</em>, or <code>HATEOAS</code>, is a means of creating self-describing APIs wherein resources returned from an API contain links to related resources. This enables clients to navigate an API with minimal understanding of the API’s URLs. Instead, it understands relationships between the resources served by the API and uses its understanding of those relationships to discover the API’s URLs as it traverses those relationships.</p>
<p>This particular flavor of HATEOAS is known as HAL (Hypertext Application Language; http://stateless.co/hal_specification.html), a simple and commonly used format for embedding hyperlinks in JSON responses.</p>
<p>The Spring HATEOAS project brings hyperlink support to Spring. It offers a set of classes and resource assemblers that can be used to add links to resources before returning them from a Spring MVC controller.</p>
<h3 id="adding-hyperlinks">Adding hyperlinks</h3>
<p>Spring HATEOAS provides two primary types that represent hyperlinked resources: <code>EntityModel</code> and <code>CollectionModel</code>. The <code>EntityModel</code> type represents a single resource, whereas <code>CollectionModel</code> is a collection of resources. Both types are capable of carrying links to other resources. When returned from a Spring MVC REST controller method, the links they carry will be included in the JSON (or XML) received by the client.</p>
<p>The most useful of the Spring HATEOAS link builders is <code>WebMvcLinkBuilder</code>. This link builder is smart enough to know what the hostname is without you having to hardcode it. And it provides a handy fluent API to help you build links relative to the base URL of any controller.</p>
<h3 id="creating-resource-assemblers">Creating resource assemblers</h3>
<h3 id="naming-embedded-relationships">Naming embedded relationships</h3>
<p>The <code>@Relation</code> annotation can help break the coupling between the JSON field name and the resource type class names as defined in Java. By annotating <code>TacoEntityModel</code> with <code>@Relation</code>, you can specify how Spring HATEOAS should name the field in the resulting JSON:</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Relation(value="taco", collectionRelation="tacos")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TacoEntityModel</span> <span class="keyword">extends</span> <span class="title">ResourceSupport</span> </span>{ </span><br><span class="line">  ...</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Here you’ve specified that when a list of <code>TacoEntityModel</code> objects is used in a <code>CollectionModel</code> object, it should be named <code>tacos</code>. And although you’re not making use of it in our API, a single <code>TacoEntityModel</code> object should be referred to in JSON as <code>taco</code>.</p>
<h2 id="enabling-data-backed-services">Enabling data-backed services</h2>
<p>Spring Data REST is another member of the Spring Data family that automatically creates REST APIs for repositories created by Spring Data. By doing little more than adding Spring Data REST to your build, you get an API with operations for each repository interface you’ve defined.</p>
<h3 id="adjusting-resource-paths-and-relation-names">Adjusting resource paths and relation names</h3>
<p>The <code>@RestResource</code> annotation lets you give the entity any relation name and path you want.</p>
<h3 id="paging-and-sorting">Paging and sorting</h3>
<p>You may have noticed that the links in the home resource all offer optional page, size, and sort parameters. By default, requests to a collection resource such as <code>/api/tacos</code> will return up to 20 items per page from the first page. But you can adjust the page size and the page displayed by specifying the <code>page</code> and <code>size</code> parameters in your request.</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="string">"localhost:8080/api/tacos?size=5&amp;page=1"</span></span><br><span class="line">curl <span class="string">"localhost:8080/api/tacos?sort=createdAt,desc&amp;page=0&amp;size=12"</span></span><br></pre></td></tr></tbody></table></figure>
<h3 id="adding-custom-endpoints">Adding custom endpoints</h3>
<h3 id="adding-custom-hyperlinks-to-spring-data-endpoints">Adding custom hyperlinks to Spring Data endpoints</h3>
<h2 id="code-files">Code files</h2>
<p><code>TacoCloud-api/web/api</code></p>
<p></p><div class="tabs" id="api"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#api-1">SpringDataRestConfiguration.java</button></li><li class="tab"><button type="button" data-href="#api-2">OrderApiController.java</button></li><li class="tab"><button type="button" data-href="#api-3">RecentTacosController</button></li><li class="tab"><button type="button" data-href="#api-4">TacoEntityModelAssembler.java</button></li><li class="tab"><button type="button" data-href="#api-5">TacoEntityModel.java</button></li><li class="tab"><button type="button" data-href="#api-6">TacoCollectionModel.java</button></li><li class="tab"><button type="button" data-href="#api-7">TacoEntityModelAssembler.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="api-1"><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringDataRestConfiguration</span> </span>{</span><br><span class="line"></span><br><span class="line">  <span class="comment">//tag::tacoProcessor[]</span></span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="keyword">public</span> RepresentationModelProcessor&lt;PagedModel&lt;EntityModel&lt;Taco&gt;&gt;&gt;</span><br><span class="line">    tacoProcessor(EntityLinks links) {</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> RepresentationModelProcessor&lt;PagedModel&lt;EntityModel&lt;Taco&gt;&gt;&gt;() {</span><br><span class="line">      <span class="meta">@Override</span></span><br><span class="line">      <span class="keyword">public</span> PagedModel&lt;EntityModel&lt;Taco&gt;&gt; process(</span><br><span class="line">    		  PagedModel&lt;EntityModel&lt;Taco&gt;&gt; resource) {</span><br><span class="line">        resource.add(</span><br><span class="line">            links.linkFor(Taco.class)</span><br><span class="line">                 .slash(<span class="string">"recent"</span>)</span><br><span class="line">                 .withRel(<span class="string">"recents"</span>));</span><br><span class="line">        <span class="keyword">return</span> resource;</span><br><span class="line">      }</span><br><span class="line">    };</span><br><span class="line">  }</span><br></pre></td></tr></tbody></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="api-2"><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(path="/orders",</span></span><br><span class="line"><span class="meta">                produces="application/json")</span></span><br><span class="line"><span class="meta">@CrossOrigin(origins="*")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderApiController</span> </span>{</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> OrderRepository repo;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">OrderApiController</span><span class="params">(OrderRepository repo)</span> </span>{</span><br><span class="line">    <span class="keyword">this</span>.repo = repo;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="meta">@GetMapping(produces="application/json")</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Iterable&lt;Order&gt; <span class="title">allOrders</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> repo.findAll();</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="meta">@PostMapping(consumes="application/json")</span></span><br><span class="line">  <span class="meta">@ResponseStatus(HttpStatus.CREATED)</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Order <span class="title">postOrder</span><span class="params">(<span class="meta">@RequestBody</span> Order order)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> repo.save(order);</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="comment">//tag::putOrder[]</span></span><br><span class="line">  <span class="meta">@PutMapping(path="/{orderId}", consumes="application/json")</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Order <span class="title">putOrder</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">                        <span class="meta">@PathVariable("orderId")</span> Long orderId,</span></span></span><br><span class="line"><span class="params"><span class="function">                        <span class="meta">@RequestBody</span> Order order)</span> </span>{</span><br><span class="line">    order.setId(orderId);</span><br><span class="line">    <span class="keyword">return</span> repo.save(order);</span><br><span class="line">  }</span><br><span class="line">  <span class="comment">//end::putOrder[]</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//tag::patchOrder[]</span></span><br><span class="line">  <span class="meta">@PatchMapping(path="/{orderId}", consumes="application/json")</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Order <span class="title">patchOrder</span><span class="params">(<span class="meta">@PathVariable("orderId")</span> Long orderId,</span></span></span><br><span class="line"><span class="params"><span class="function">                          <span class="meta">@RequestBody</span> Order patch)</span> </span>{</span><br><span class="line"></span><br><span class="line">    Order order = repo.findById(orderId).get();</span><br><span class="line">    <span class="keyword">if</span> (patch.getDeliveryName() != <span class="keyword">null</span>) {</span><br><span class="line">      order.setDeliveryName(patch.getDeliveryName());</span><br><span class="line">    }</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">if</span> (patch.getCcCVV() != <span class="keyword">null</span>) {</span><br><span class="line">      order.setCcCVV(patch.getCcCVV());</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> repo.save(order);</span><br><span class="line">  }</span><br><span class="line">  <span class="comment">//end::patchOrder[]</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//tag::deleteOrder[]</span></span><br><span class="line">  <span class="meta">@DeleteMapping("/{orderId}")</span></span><br><span class="line">  <span class="meta">@ResponseStatus(HttpStatus.NO_CONTENT)</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteOrder</span><span class="params">(<span class="meta">@PathVariable("orderId")</span> Long orderId)</span> </span>{</span><br><span class="line">    <span class="keyword">try</span> {</span><br><span class="line">      repo.deleteById(orderId);</span><br><span class="line">    } <span class="keyword">catch</span> (EmptyResultDataAccessException e) {}</span><br><span class="line">  }</span><br><span class="line">  <span class="comment">//end::deleteOrder[]</span></span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="api-3"><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RepositoryRestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RecentTacosController</span> </span>{</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> TacoRepository tacoRepo;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">RecentTacosController</span><span class="params">(TacoRepository tacoRepo)</span> </span>{</span><br><span class="line">    <span class="keyword">this</span>.tacoRepo = tacoRepo;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="meta">@GetMapping(path="/tacos/recent", produces="application/hal+json")</span></span><br><span class="line">  <span class="keyword">public</span> ResponseEntity&lt;CollectionModel&lt;TacoEntityModel&gt;&gt; recentTacos() {</span><br><span class="line">    PageRequest page = PageRequest.of(</span><br><span class="line">                          <span class="number">0</span>, <span class="number">12</span>, Sort.by(<span class="string">"createdAt"</span>).descending());</span><br><span class="line">    List&lt;Taco&gt; tacos = tacoRepo.findAll(page).getContent();</span><br><span class="line">     </span><br><span class="line">    CollectionModel&lt;TacoEntityModel&gt; tacoResources = </span><br><span class="line">    		<span class="keyword">new</span> TacoEntityModelAssembler().toCollectionModel(tacos);</span><br><span class="line">    CollectionModel&lt;TacoEntityModel&gt; recentResources = </span><br><span class="line">            <span class="keyword">new</span> CollectionModel&lt;TacoEntityModel&gt;(tacoResources);</span><br><span class="line">    </span><br><span class="line">    recentResources.add(</span><br><span class="line">        linkTo(methodOn(RecentTacosController.class).recentTacos())</span><br><span class="line">            .withRel(<span class="string">"recents"</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity&lt;&gt;(recentResources, HttpStatus.OK);</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="api-4"><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TacoEntityModelAssembler</span></span></span><br><span class="line"><span class="class">       <span class="keyword">extends</span> <span class="title">RepresentationModelAssemblerSupport</span>&lt;<span class="title">Taco</span>, <span class="title">TacoEntityModel</span>&gt; </span>{</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">TacoEntityModelAssembler</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">super</span>(DesignTacoController.class, TacoEntityModel.class);</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> TacoEntityModel <span class="title">instantiateModel</span><span class="params">(Taco taco)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> TacoEntityModel(taco);</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> TacoEntityModel <span class="title">toModel</span><span class="params">(Taco taco)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> createModelWithId(taco.getId(), taco);</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="api-5"><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Relation(value="taco", collectionRelation="tacos")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TacoEntityModel</span> <span class="keyword">extends</span> <span class="title">EntityModel</span>&lt;<span class="title">TacoEntityModel</span>&gt; </span>{</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> IngredientEntityModelAssembler </span><br><span class="line">            ingredientAssembler = <span class="keyword">new</span> IngredientEntityModelAssembler();</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Getter</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Getter</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> Date createdAt;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Getter</span></span><br><span class="line"><span class="comment">//end::TacoEntityModelOriginal[]</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> CollectionModel&lt;IngredientEntityModel&gt; ingredients;</span><br><span class="line"></span><br><span class="line"><span class="comment">//end::TacoEntityModelNew[]</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">//tag::TacoEntityModelOriginal[]</span></span><br><span class="line"><span class="comment">  private List&lt;Ingredient&gt; ingredients;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  public TacoResource(Taco taco) {</span></span><br><span class="line"><span class="comment">    this.name = taco.getName();</span></span><br><span class="line"><span class="comment">    this.createdAt = taco.getCreatedAt();</span></span><br><span class="line"><span class="comment">    this.ingredients = taco.getIngredients();</span></span><br><span class="line"><span class="comment">  }</span></span><br><span class="line"><span class="comment">//end::TacoEntityModelOriginal[]  </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//tag::TacoEntityModelNew[]</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">TacoEntityModel</span><span class="params">(Taco taco)</span> </span>{</span><br><span class="line">	    <span class="keyword">this</span>.name = taco.getName();</span><br><span class="line">	    <span class="keyword">this</span>.createdAt = taco.getCreatedAt();</span><br><span class="line">	    <span class="keyword">this</span>.ingredients = </span><br><span class="line">	        ingredientAssembler.toCollectionModel(taco.getIngredients());</span><br><span class="line">  }</span><br><span class="line"><span class="comment">//tag::TacoEntityModelOriginal[]  </span></span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="api-6"><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.hateoas.CollectionModel;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TacoCollectionModel</span> <span class="keyword">extends</span> <span class="title">CollectionModel</span>&lt;<span class="title">TacoEntityModel</span>&gt; </span>{</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">TacoCollectionModel</span><span class="params">(List&lt;TacoEntityModel&gt; tacoResources)</span> </span>{</span><br><span class="line">    <span class="keyword">super</span>(tacoResources);</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="api-7"><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TacoEntityModelAssembler</span></span></span><br><span class="line"><span class="class">       <span class="keyword">extends</span> <span class="title">RepresentationModelAssemblerSupport</span>&lt;<span class="title">Taco</span>, <span class="title">TacoEntityModel</span>&gt; </span>{</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">TacoEntityModelAssembler</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">super</span>(DesignTacoController.class, TacoEntityModel.class);</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> TacoEntityModel <span class="title">instantiateModel</span><span class="params">(Taco taco)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> TacoEntityModel(taco);</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> TacoEntityModel <span class="title">toModel</span><span class="params">(Taco taco)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> createModelWithId(taco.getId(), taco);</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p></p>
<h1 id="ch8-consuming-rest-services">Ch8 Consuming REST Services</h1>
<p>A Spring application can consume a REST API with</p>
<ul>
<li><strong>RestTemplate</strong> — A straightforward, synchronous REST client provided by the core Spring Framework.</li>
<li><strong>Traverson</strong>— A hyperlink-aware, synchronous REST client provided by Spring HATEOAS. Inspired from a JavaScript library of the same name.</li>
<li><strong>WebClient</strong> — A reactive, asynchronous REST client.</li>
</ul>
<h2 id="consuming-rest-endpoints-with-resttemplate">Consuming REST endpoints with RestTemplate</h2>
<p>There’s a lot that goes into interacting with a REST resource from the client’s perspective—mostly tedium and boilerplate. Working with low-level HTTP libraries, the client needs to create a client instance and a request object, execute the request, interpret the response, map the response to domain objects, and handle any exceptions that may be thrown along the way. And all of this boilerplate is repeated, regardless of what HTTP request is sent.</p>
<img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/reading-notes/cqNotes/SoftwareDev/SpringInAction/spring-in-action-notes-04/ch8-consume-rest-methods.png" class="" title="RestTemplate defines 12 unique operations, each of which is overloaded, providing a total of 41 methods">
<p>Most of the methods in the above table are overloaded into three method forms:</p>
<ul>
<li><p>One accepts a String URL specification with URL parameters specified in a variable argument list.</p></li>
<li><p>One accepts a String URL specification with URL parameters specified in a <code>Map&lt;String,String&gt;</code>.</p></li>
<li><p>One accepts a java.net.URI as the URL specification, with no support for parameterized URLs.</p></li>
</ul>
<h2 id="navigating-rest-apis-with-traverson">Navigating REST APIs with Traverson</h2>
<h2 id="code-files-1">Code files</h2>
<p><code>taco-cloud restclient</code></p>
<p></p><div class="tabs" id="api"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#api-1">RestExamples.java</button></li><li class="tab"><button type="button" data-href="#api-2">TacoCloudClient.java</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="api-1"><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="meta">@ComponentScan</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RestExamples</span> </span>{</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">    SpringApplication.run(RestExamples.class, args);</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="comment">//tag::restTemplateBean[]</span></span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> RestTemplate <span class="title">restTemplate</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> RestTemplate();</span><br><span class="line">  }</span><br><span class="line">  <span class="comment">//end::restTemplateBean[]</span></span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> CommandLineRunner <span class="title">fetchIngredients</span><span class="params">(TacoCloudClient tacoCloudClient)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> args -&gt; {</span><br><span class="line">      log.info(<span class="string">"----------------------- GET -------------------------"</span>);</span><br><span class="line">      log.info(<span class="string">"GETTING INGREDIENT BY IDE"</span>);</span><br><span class="line">      log.info(<span class="string">"Ingredient:  "</span> + tacoCloudClient.getIngredientById(<span class="string">"CHED"</span>));</span><br><span class="line">      log.info(<span class="string">"GETTING ALL INGREDIENTS"</span>);</span><br><span class="line">      List&lt;Ingredient&gt; ingredients = tacoCloudClient.getAllIngredients();</span><br><span class="line">      log.info(<span class="string">"All ingredients:"</span>);</span><br><span class="line">      <span class="keyword">for</span> (Ingredient ingredient : ingredients) {</span><br><span class="line">        log.info(<span class="string">"   - "</span> + ingredient);</span><br><span class="line">      }</span><br><span class="line">    };</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> CommandLineRunner <span class="title">putAnIngredient</span><span class="params">(TacoCloudClient tacoCloudClient)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> args -&gt; {</span><br><span class="line">      log.info(<span class="string">"----------------------- PUT -------------------------"</span>);</span><br><span class="line">      Ingredient before = tacoCloudClient.getIngredientById(<span class="string">"LETC"</span>);</span><br><span class="line">      log.info(<span class="string">"BEFORE:  "</span> + before);</span><br><span class="line">      tacoCloudClient.updateIngredient(<span class="keyword">new</span> Ingredient(<span class="string">"LETC"</span>, <span class="string">"Shredded Lettuce"</span>, Ingredient.Type.VEGGIES));</span><br><span class="line">      Ingredient after = tacoCloudClient.getIngredientById(<span class="string">"LETC"</span>);</span><br><span class="line">      log.info(<span class="string">"AFTER:  "</span> + after);</span><br><span class="line">    };</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> CommandLineRunner <span class="title">addAnIngredient</span><span class="params">(TacoCloudClient tacoCloudClient)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> args -&gt; {</span><br><span class="line">      log.info(<span class="string">"----------------------- POST -------------------------"</span>);</span><br><span class="line">      Ingredient chix = <span class="keyword">new</span> Ingredient(<span class="string">"CHIX"</span>, <span class="string">"Shredded Chicken"</span>, Ingredient.Type.PROTEIN);</span><br><span class="line">      Ingredient chixAfter = tacoCloudClient.createIngredient(chix);</span><br><span class="line">      log.info(<span class="string">"AFTER=1:  "</span> + chixAfter);</span><br><span class="line"><span class="comment">//      Ingredient beefFajita = new Ingredient("BFFJ", "Beef Fajita", Ingredient.Type.PROTEIN);</span></span><br><span class="line"><span class="comment">//      URI uri = tacoCloudClient.createIngredient(beefFajita);</span></span><br><span class="line"><span class="comment">//      log.info("AFTER-2:  " + uri);      </span></span><br><span class="line"><span class="comment">//      Ingredient shrimp = new Ingredient("SHMP", "Shrimp", Ingredient.Type.PROTEIN);</span></span><br><span class="line"><span class="comment">//      Ingredient shrimpAfter = tacoCloudClient.createIngredient(shrimp);</span></span><br><span class="line"><span class="comment">//      log.info("AFTER-3:  " + shrimpAfter);      </span></span><br><span class="line">    };</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> CommandLineRunner <span class="title">deleteAnIngredient</span><span class="params">(TacoCloudClient tacoCloudClient)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> args -&gt; {</span><br><span class="line">      log.info(<span class="string">"----------------------- DELETE -------------------------"</span>);</span><br><span class="line">      <span class="comment">// start by adding a few ingredients so that we can delete them later...</span></span><br><span class="line">      Ingredient beefFajita = <span class="keyword">new</span> Ingredient(<span class="string">"BFFJ"</span>, <span class="string">"Beef Fajita"</span>, Ingredient.Type.PROTEIN);</span><br><span class="line">      tacoCloudClient.createIngredient(beefFajita);</span><br><span class="line">      Ingredient shrimp = <span class="keyword">new</span> Ingredient(<span class="string">"SHMP"</span>, <span class="string">"Shrimp"</span>, Ingredient.Type.PROTEIN);</span><br><span class="line">      tacoCloudClient.createIngredient(shrimp);</span><br><span class="line"></span><br><span class="line">      </span><br><span class="line">      Ingredient before = tacoCloudClient.getIngredientById(<span class="string">"CHIX"</span>);</span><br><span class="line">      log.info(<span class="string">"BEFORE:  "</span> + before);</span><br><span class="line">      tacoCloudClient.deleteIngredient(before);</span><br><span class="line">      Ingredient after = tacoCloudClient.getIngredientById(<span class="string">"CHIX"</span>);</span><br><span class="line">      log.info(<span class="string">"AFTER:  "</span> + after);</span><br><span class="line">      before = tacoCloudClient.getIngredientById(<span class="string">"BFFJ"</span>);</span><br><span class="line">      log.info(<span class="string">"BEFORE:  "</span> + before);</span><br><span class="line">      tacoCloudClient.deleteIngredient(before);</span><br><span class="line">      after = tacoCloudClient.getIngredientById(<span class="string">"BFFJ"</span>);</span><br><span class="line">      log.info(<span class="string">"AFTER:  "</span> + after);</span><br><span class="line">      before = tacoCloudClient.getIngredientById(<span class="string">"SHMP"</span>);</span><br><span class="line">      log.info(<span class="string">"BEFORE:  "</span> + before);</span><br><span class="line">      tacoCloudClient.deleteIngredient(before);</span><br><span class="line">      after = tacoCloudClient.getIngredientById(<span class="string">"SHMP"</span>);</span><br><span class="line">      log.info(<span class="string">"AFTER:  "</span> + after);</span><br><span class="line">    };</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// Traverson examples</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Traverson <span class="title">traverson</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="comment">//tag::traverson[]</span></span><br><span class="line">    Traverson traverson = <span class="keyword">new</span> Traverson(</span><br><span class="line">        URI.create(<span class="string">"http://localhost:8080/api"</span>), MediaTypes.HAL_JSON);</span><br><span class="line">    <span class="comment">//end::traverson[]</span></span><br><span class="line">    <span class="keyword">return</span> traverson;</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> CommandLineRunner <span class="title">traversonGetIngredients</span><span class="params">(TacoCloudClient tacoCloudClient)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> args -&gt; {</span><br><span class="line">      Iterable&lt;Ingredient&gt; ingredients = tacoCloudClient.getAllIngredientsWithTraverson();</span><br><span class="line">      log.info(<span class="string">"----------------------- GET INGREDIENTS WITH TRAVERSON -------------------------"</span>);</span><br><span class="line">      <span class="keyword">for</span> (Ingredient ingredient : ingredients) {</span><br><span class="line">        log.info(<span class="string">"   -  "</span> + ingredient);</span><br><span class="line">      }</span><br><span class="line">    };</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> CommandLineRunner <span class="title">traversonSaveIngredient</span><span class="params">(TacoCloudClient tacoCloudClient)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> args -&gt; {</span><br><span class="line">      Ingredient pico = tacoCloudClient.addIngredient(</span><br><span class="line">          <span class="keyword">new</span> Ingredient(<span class="string">"PICO"</span>, <span class="string">"Pico de Gallo"</span>, Ingredient.Type.SAUCE));</span><br><span class="line">      List&lt;Ingredient&gt; allIngredients = tacoCloudClient.getAllIngredients();</span><br><span class="line">      log.info(<span class="string">"----------------------- ALL INGREDIENTS AFTER SAVING PICO -------------------------"</span>);</span><br><span class="line">      <span class="keyword">for</span> (Ingredient ingredient : allIngredients) {</span><br><span class="line">        log.info(<span class="string">"   -  "</span> + ingredient);</span><br><span class="line">      }</span><br><span class="line">      tacoCloudClient.deleteIngredient(pico);</span><br><span class="line">    };</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> CommandLineRunner <span class="title">traversonRecentTacos</span><span class="params">(TacoCloudClient tacoCloudClient)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> args -&gt; {</span><br><span class="line">      Iterable&lt;Taco&gt; recentTacos = tacoCloudClient.getRecentTacosWithTraverson();</span><br><span class="line">      log.info(<span class="string">"----------------------- GET RECENT TACOS WITH TRAVERSON -------------------------"</span>);</span><br><span class="line">      <span class="keyword">for</span> (Taco taco : recentTacos) {</span><br><span class="line">        log.info(<span class="string">"   -  "</span> + taco);</span><br><span class="line">      }</span><br><span class="line">    };</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="api-2"><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TacoCloudClient</span> </span>{</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> RestTemplate rest;</span><br><span class="line">  <span class="keyword">private</span> Traverson traverson;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">TacoCloudClient</span><span class="params">(RestTemplate rest, Traverson traverson)</span> </span>{</span><br><span class="line">    <span class="keyword">this</span>.rest = rest;</span><br><span class="line">    <span class="keyword">this</span>.traverson = traverson;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// GET examples</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   * Specify parameter as varargs argument</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="comment">//tag::getIngredientById[]</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Ingredient <span class="title">getIngredientById</span><span class="params">(String ingredientId)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> rest.getForObject(<span class="string">"http://localhost:8080/ingredients/{id}"</span>,</span><br><span class="line">                             Ingredient.class, ingredientId);</span><br><span class="line">  }</span><br><span class="line">  <span class="comment">//end::getIngredientById[]</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   * Alternate implementations...</span></span><br><span class="line"><span class="comment">   * The next three methods are alternative implementations of</span></span><br><span class="line"><span class="comment">   * getIngredientById() as shown in chapter 6. If you'd like to try</span></span><br><span class="line"><span class="comment">   * any of them out, comment out the previous method and uncomment</span></span><br><span class="line"><span class="comment">   * the variant you want to use.</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   * Specify parameters with a map</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  //tag::getIngredientById2[]</span></span><br><span class="line"><span class="comment">  public Ingredient getIngredientById(String ingredientId) {</span></span><br><span class="line"><span class="comment">    Map&lt;String, String&gt; urlVariables = new HashMap&lt;&gt;();</span></span><br><span class="line"><span class="comment">    urlVariables.put("id", ingredientId);</span></span><br><span class="line"><span class="comment">    return rest.getForObject("http://localhost:8080/ingredients/{id}",</span></span><br><span class="line"><span class="comment">        Ingredient.class, urlVariables);</span></span><br><span class="line"><span class="comment">  }</span></span><br><span class="line"><span class="comment">  //end::getIngredientById2[]</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   * Request with URI instead of String</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  //tag::getIngredientById3[]</span></span><br><span class="line"><span class="comment">  public Ingredient getIngredientById(String ingredientId) {</span></span><br><span class="line"><span class="comment">    Map&lt;String, String&gt; urlVariables = new HashMap&lt;&gt;();</span></span><br><span class="line"><span class="comment">    urlVariables.put("id", ingredientId);</span></span><br><span class="line"><span class="comment">    URI url = UriComponentsBuilder</span></span><br><span class="line"><span class="comment">              .fromHttpUrl("http://localhost:8080/ingredients/{id}")</span></span><br><span class="line"><span class="comment">              .build(urlVariables);</span></span><br><span class="line"><span class="comment">    return rest.getForObject(url, Ingredient.class);</span></span><br><span class="line"><span class="comment">  }</span></span><br><span class="line"><span class="comment">  //end::getIngredientById3[]</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   * Use getForEntity() instead of getForObject()</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  //tag::getIngredientById4[]</span></span><br><span class="line"><span class="comment">  public Ingredient getIngredientById(String ingredientId) {</span></span><br><span class="line"><span class="comment">    ResponseEntity&lt;Ingredient&gt; responseEntity =</span></span><br><span class="line"><span class="comment">        rest.getForEntity("http://localhost:8080/ingredients/{id}",</span></span><br><span class="line"><span class="comment">            Ingredient.class, ingredientId);</span></span><br><span class="line"><span class="comment">    log.info("Fetched time: " +</span></span><br><span class="line"><span class="comment">            responseEntity.getHeaders().getDate());</span></span><br><span class="line"><span class="comment">    return responseEntity.getBody();</span></span><br><span class="line"><span class="comment">  }</span></span><br><span class="line"><span class="comment">  //end::getIngredientById4[]</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> List&lt;Ingredient&gt; <span class="title">getAllIngredients</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> rest.exchange(<span class="string">"http://localhost:8080/ingredients"</span>,</span><br><span class="line">            HttpMethod.GET, <span class="keyword">null</span>, <span class="keyword">new</span> ParameterizedTypeReference&lt;List&lt;Ingredient&gt;&gt;() {})</span><br><span class="line">        .getBody();</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// PUT examples</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//tag::updateIngredient[]</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateIngredient</span><span class="params">(Ingredient ingredient)</span> </span>{</span><br><span class="line">    rest.put(<span class="string">"http://localhost:8080/ingredients/{id}"</span>,</span><br><span class="line">          ingredient, ingredient.getId());</span><br><span class="line">  }</span><br><span class="line">  <span class="comment">//end::updateIngredient[]</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// POST examples</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">//tag::createIngredient[]</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Ingredient <span class="title">createIngredient</span><span class="params">(Ingredient ingredient)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> rest.postForObject(<span class="string">"http://localhost:8080/ingredients"</span>,</span><br><span class="line">        ingredient, Ingredient.class);</span><br><span class="line">  }</span><br><span class="line">  <span class="comment">//end::createIngredient[]</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   * Alternate implementations...</span></span><br><span class="line"><span class="comment">   * The next two methods are alternative implementations of</span></span><br><span class="line"><span class="comment">   * createIngredient() as shown in chapter 6. If you'd like to try</span></span><br><span class="line"><span class="comment">   * any of them out, comment out the previous method and uncomment</span></span><br><span class="line"><span class="comment">   * the variant you want to use.</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  //tag::createIngredient2[]</span></span><br><span class="line"><span class="comment">  public java.net.URI createIngredient(Ingredient ingredient) {</span></span><br><span class="line"><span class="comment">    return rest.postForLocation("http://localhost:8080/ingredients",</span></span><br><span class="line"><span class="comment">        ingredient);</span></span><br><span class="line"><span class="comment">  }</span></span><br><span class="line"><span class="comment">  //end::createIngredient2[]</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  //tag::createIngredient3[]</span></span><br><span class="line"><span class="comment">  public Ingredient createIngredient(Ingredient ingredient) {</span></span><br><span class="line"><span class="comment">    ResponseEntity&lt;Ingredient&gt; responseEntity =</span></span><br><span class="line"><span class="comment">           rest.postForEntity("http://localhost:8080/ingredients",</span></span><br><span class="line"><span class="comment">                              ingredient,</span></span><br><span class="line"><span class="comment">                              Ingredient.class);</span></span><br><span class="line"><span class="comment">    log.info("New resource created at " +</span></span><br><span class="line"><span class="comment">             responseEntity.getHeaders().getLocation());</span></span><br><span class="line"><span class="comment">    return responseEntity.getBody();</span></span><br><span class="line"><span class="comment">  }</span></span><br><span class="line"><span class="comment">  //end::createIngredient3[]</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// DELETE examples</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//tag::deleteIngredient[]</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteIngredient</span><span class="params">(Ingredient ingredient)</span> </span>{</span><br><span class="line">    rest.delete(<span class="string">"http://localhost:8080/ingredients/{id}"</span>,</span><br><span class="line">        ingredient.getId());</span><br><span class="line">  }</span><br><span class="line">  <span class="comment">//end::deleteIngredient[]</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// Traverson with RestTemplate examples</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Iterable&lt;Ingredient&gt; <span class="title">getAllIngredientsWithTraverson</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="comment">//tag::getWithTraverson[]</span></span><br><span class="line">    ParameterizedTypeReference&lt;CollectionModel&lt;Ingredient&gt;&gt; ingredientType =</span><br><span class="line">        <span class="keyword">new</span> ParameterizedTypeReference&lt;CollectionModel&lt;Ingredient&gt;&gt;() {};</span><br><span class="line"></span><br><span class="line">    CollectionModel&lt;Ingredient&gt; ingredientRes =</span><br><span class="line">        traverson</span><br><span class="line">          .follow(<span class="string">"ingredients"</span>)</span><br><span class="line">          .toObject(ingredientType);</span><br><span class="line"></span><br><span class="line">    Collection&lt;Ingredient&gt; ingredients = ingredientRes.getContent();</span><br><span class="line">    <span class="comment">//end::getWithTraverson[]</span></span><br><span class="line">    <span class="keyword">return</span> ingredients;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="comment">//tag::addIngredient[]</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Ingredient <span class="title">addIngredient</span><span class="params">(Ingredient ingredient)</span> </span>{</span><br><span class="line">    String ingredientsUrl = traverson</span><br><span class="line">        .follow(<span class="string">"ingredients"</span>)</span><br><span class="line">        .asLink()</span><br><span class="line">        .getHref();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> rest.postForObject(ingredientsUrl,</span><br><span class="line">                              ingredient,</span><br><span class="line">                              Ingredient.class);</span><br><span class="line">  }</span><br><span class="line">  <span class="comment">//end::addIngredient[]</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Iterable&lt;Taco&gt; <span class="title">getRecentTacosWithTraverson</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="comment">//tag::getWithTraverson2[]</span></span><br><span class="line">    ParameterizedTypeReference&lt;CollectionModel&lt;Taco&gt;&gt; tacoType =</span><br><span class="line">        <span class="keyword">new</span> ParameterizedTypeReference&lt;CollectionModel&lt;Taco&gt;&gt;() {};</span><br><span class="line"></span><br><span class="line">    CollectionModel&lt;Taco&gt; tacoRes =</span><br><span class="line">        traverson</span><br><span class="line">          .follow(<span class="string">"tacos"</span>)</span><br><span class="line">          .follow(<span class="string">"recents"</span>)</span><br><span class="line">          .toObject(tacoType);</span><br><span class="line"></span><br><span class="line">    Collection&lt;Taco&gt; tacos = tacoRes.getContent();</span><br><span class="line">    <span class="comment">//end::getWithTraverson2[]</span></span><br><span class="line">    <span class="comment">// Alternatively, list the two paths in the same call to follow()</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    //tag::getWithTraverson3[]</span></span><br><span class="line"><span class="comment">    CollectionModel&lt;Taco&gt; tacoRes =</span></span><br><span class="line"><span class="comment">       traverson</span></span><br><span class="line"><span class="comment">         .follow("tacos", "recents")</span></span><br><span class="line"><span class="comment">         .toObject(tacoType);</span></span><br><span class="line"><span class="comment">    //end::getWithTraverson3[]</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">return</span> tacos;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p></p>
<script type="text&#x2F;javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.7.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.7.0/dist/mindmap.min.css"></article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/reading-notes/tags/software-dev/">software_dev</a><a class="post-meta__tags" href="/reading-notes/tags/spring/">spring</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/reading-notes/cqNotes/SoftwareDev/SpringInAction/spring-in-action-notes-05/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.pixabay.com/photo/2015/06/08/15/11/typewriter-801921_1280.jpg" onerror="onerror=null;src='/reading-notes/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Spring In Action Notes (5)</div></div></a></div><div class="next-post pull-right"><a href="/reading-notes/cqNotes/SoftwareDev/SpringInAction/spring-in-action-notes-03/"><img class="next-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.pixabay.com/photo/2015/06/08/15/11/typewriter-801921_1280.jpg" onerror="onerror=null;src='/reading-notes/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Spring In Action Notes (3)</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/reading-notes/cqNotes/SoftwareDev/SpringInAction/spring-in-action-notes-07/" title="Spring In Action Notes (7)"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.pixabay.com/photo/2015/06/08/15/11/typewriter-801921_1280.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-01</div><div class="title">Spring In Action Notes (7)</div></div></a></div><div><a href="/reading-notes/cqNotes/SoftwareDev/SpringInAction/spring-in-action-notes-06/" title="Spring In Action Notes (6)"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.pixabay.com/photo/2021/09/09/04/38/binary-6609473_1280.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-29</div><div class="title">Spring In Action Notes (6)</div></div></a></div><div><a href="/reading-notes/cqNotes/SoftwareDev/SpringInAction/spring-in-action-notes-03/" title="Spring In Action Notes (3)"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.pixabay.com/photo/2015/06/08/15/11/typewriter-801921_1280.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-28</div><div class="title">Spring In Action Notes (3)</div></div></a></div><div><a href="/reading-notes/cqNotes/SoftwareDev/SpringInAction/spring-in-action-notes-02/" title="Spring In Action Notes (2)"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.pixabay.com/photo/2012/10/29/15/38/binary-code-63529_1280.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-27</div><div class="title">Spring In Action Notes (2)</div></div></a></div><div><a href="/reading-notes/cqNotes/SoftwareDev/SpringInAction/spring-in-action-notes-01/" title="Spring In Action Reading Notes (1)"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.pixabay.com/photo/2016/03/17/23/07/abstract-1264071_1280.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-26</div><div class="title">Spring In Action Reading Notes (1)</div></div></a></div><div><a href="/reading-notes/cqNotes/SoftwareDev/DataStructureAlgo/data-structure-algo-03/" title="data-structure-algo-03"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.pixabay.com/photo/2015/06/08/15/11/typewriter-801921_1280.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-16</div><div class="title">data-structure-algo-03</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ch7-creating-rest-services"><span class="toc-number">1.</span> <span class="toc-text">Ch7 Creating REST Services</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#writing-restful-controllers"><span class="toc-number">1.1.</span> <span class="toc-text">Writing RESTful controllers</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#retrieving-data-from-the-server"><span class="toc-number">1.1.1.</span> <span class="toc-text">Retrieving data from the server</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sending-data-to-the-server"><span class="toc-number">1.1.2.</span> <span class="toc-text">Sending data to the server</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#updating-data-on-the-server"><span class="toc-number">1.1.3.</span> <span class="toc-text">Updating data on the server</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#deleting-data-from-the-server"><span class="toc-number">1.1.4.</span> <span class="toc-text">Deleting data from the server</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#enabling-hypermedia"><span class="toc-number">1.2.</span> <span class="toc-text">Enabling hypermedia</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#adding-hyperlinks"><span class="toc-number">1.2.1.</span> <span class="toc-text">Adding hyperlinks</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#creating-resource-assemblers"><span class="toc-number">1.2.2.</span> <span class="toc-text">Creating resource assemblers</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#naming-embedded-relationships"><span class="toc-number">1.2.3.</span> <span class="toc-text">Naming embedded relationships</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#enabling-data-backed-services"><span class="toc-number">1.3.</span> <span class="toc-text">Enabling data-backed services</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#adjusting-resource-paths-and-relation-names"><span class="toc-number">1.3.1.</span> <span class="toc-text">Adjusting resource paths and relation names</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#paging-and-sorting"><span class="toc-number">1.3.2.</span> <span class="toc-text">Paging and sorting</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#adding-custom-endpoints"><span class="toc-number">1.3.3.</span> <span class="toc-text">Adding custom endpoints</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#adding-custom-hyperlinks-to-spring-data-endpoints"><span class="toc-number">1.3.4.</span> <span class="toc-text">Adding custom hyperlinks to Spring Data endpoints</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#code-files"><span class="toc-number">1.4.</span> <span class="toc-text">Code files</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ch8-consuming-rest-services"><span class="toc-number">2.</span> <span class="toc-text">Ch8 Consuming REST Services</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#consuming-rest-endpoints-with-resttemplate"><span class="toc-number">2.1.</span> <span class="toc-text">Consuming REST endpoints with RestTemplate</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#navigating-rest-apis-with-traverson"><span class="toc-number">2.2.</span> <span class="toc-text">Navigating REST APIs with Traverson</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#code-files-1"><span class="toc-number">2.3.</span> <span class="toc-text">Code files</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="Increase font size"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="Decrease font size"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/reading-notes/js/utils.js"></script><script src="/reading-notes/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/reading-notes/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      false && mermaid.init()
    })
  }
}</script></div></div><!-- hexo injector body_end start --><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><!-- hexo injector body_end end --></body></html>