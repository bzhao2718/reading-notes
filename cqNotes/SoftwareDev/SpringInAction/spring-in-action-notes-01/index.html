<!DOCTYPE html><html class="hide-aside" lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Spring In Action Reading Notes (1) | ReadingNotes</title><meta name="keywords" content="software_dev,spring"><meta name="author"><meta name="copyright"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Ch1 Getting Started What is Spring  The Spring Framework is an application framework and inversion of control container for the Java platform. Spring Framework - Wikipedia   At its core, Spring framew">
<meta property="og:type" content="article">
<meta property="og:title" content="Spring In Action Reading Notes (1)">
<meta property="og:url" content="https://bzhao2718.github.io/reading-notes/cqNotes/SoftwareDev/SpringInAction/spring-in-action-notes-01/index.html">
<meta property="og:site_name" content="ReadingNotes">
<meta property="og:description" content="Ch1 Getting Started What is Spring  The Spring Framework is an application framework and inversion of control container for the Java platform. Spring Framework - Wikipedia   At its core, Spring framew">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://bzhao2718.github.io/reading-notes/default_cover/gamer-6022003.svg">
<meta property="article:published_time" content="2021-10-26T04:06:32.000Z">
<meta property="article:modified_time" content="2021-11-25T19:00:56.077Z">
<meta property="article:tag" content="software_dev">
<meta property="article:tag" content="spring">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://bzhao2718.github.io/reading-notes/default_cover/gamer-6022003.svg"><link rel="shortcut icon" href="/reading-notes/img/favicon.png"><link rel="canonical" href="https://bzhao2718.github.io/reading-notes/cqNotes/SoftwareDev/SpringInAction/spring-in-action-notes-01/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/reading-notes/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/reading-notes/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":500},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Spring In Action Reading Notes (1)',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-11-26 03:00:56'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://unpkg.zhimg.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/hexo-butterfly-tag-plugins-plus@latest/lib/carousel-touch.min.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.2.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/reading-notes/archives/"><div class="headline">Articles</div><div class="length-num">102</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/reading-notes/tags/"><div class="headline">Tags</div><div class="length-num">22</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/reading-notes/categories/"><div class="headline">Categories</div><div class="length-num">12</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/reading-notes/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/reading-notes/">ReadingNotes</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/reading-notes/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">Spring In Action Reading Notes (1)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2021-10-26T04:06:32.000Z" title="Created 2021-10-26 12:06:32">2021-10-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2021-11-25T19:00:56.077Z" title="Updated 2021-11-26 03:00:56">2021-11-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/reading-notes/categories/SoftwareDev/">SoftwareDev</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>22min</span></span></div></div></div><article class="post-content" id="article-container"><h1 id="ch1-getting-started">Ch1 Getting Started</h1>
<h2 id="what-is-spring">What is Spring</h2>
<blockquote>
<p>The Spring Framework is an application framework and inversion of
control container for the Java platform. <a target="_blank" rel="noopener external nofollow noreferrer" href="https://en.wikipedia.org/wiki/Spring_Framework">Spring Framework -
Wikipedia</a></p>
</blockquote>
<blockquote>
<p>At its core, Spring framework is really just a dependency injection
container, with a couple of convenience layers (think: database access,
proxies, aspect-oriented programming, RPC, a web mcv framework) added on
top.</p>
</blockquote>
<p>Any non-trivial application is composed of many components, each
responsible for its won piece of the overall application functionality,
coordinating with the other application elements to get the job done.
When the application is run, those components somehow need to be created
and introduced to each other.</p>
<p>At its core, Spring offers a <code>container</code>, often referred
to as the <em>Spring application context</em>, that creates and manages
application components. These components, or <code>beans</code>, are
wired together inside the Spring application context to make a complete
application, much like bricks, mortar, timber, nails, plumbing, and
wiring are bound together to make a house.</p>
<p>The act of wiring beans together is based on a pattern known as
<code>dependency injection (DI)</code>. Rather than have components
create and maintain the lifecycle of other beans that they depend on, a
dependency-injected application relies on a separate entity (the
container) to create and maintain all components and inject those into
the beans that need them. This is done typically through constructor
arguments or property accessor methods.</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServiceConfiguration</span> {</span><br><span class="line">	<span class="meta">@Bean</span> </span><br><span class="line">	<span class="keyword">public</span> InventoryService <span class="title function_">inventoryService</span><span class="params">()</span> {</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">InventoryService</span>();</span><br><span class="line">  }</span><br><span class="line">	<span class="meta">@Bean</span> </span><br><span class="line">  <span class="keyword">public</span> ProductService <span class="title function_">productService</span><span class="params">()</span> { </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> 	<span class="title class_">ProductService</span>(inventoryService()); </span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>The <code>@Configuration</code> annotation indicates to Spring that
this is s a configuration class that will provide beans to the Spring
application context. The configuration’s class methods are annotated
with <code>@Bean</code>, indicating that the objects they return should
be added as beans in the application context (where, by defaults their
respective bean IDs will be the same as the names of the methods that
define them).</p>
<p>Automatic configuration has its roots in the Spring techniques known
as <code>autowiring</code> and <code>component scanning</code>. With
component scanning, Spring can automatically discover components from an
application’s class path and create them as beans in the Spring
application context. With auto wiring, Spring automatically injects the
components with the other beans that they depend on.</p>
<p>Spring Boot is an extension of the Spring Framework that offers
several productivity enhancements. The most well-known of these
enhancements is <code>autoconfiguration</code>, where Spring Boot can
make reasonable guesses of what components need to be configured and
wired together, based on entries in the class path, environment
variables, and other factors.</p>
<p>Because you’ll be running the application from an executable JAR,
it’s important to have a main class that will be executed when that JAR
file is run. You’ll also need at least a minimal amount of Spring
configuration to bootstrap the application. (That’s what you’ll fin din
the <em>TacoCloudApplication</em> class).</p>
<p><code>@SpringBootApplication</code> is a composite annotation that
combines three other annotations:</p>
<ul>
<li><code>@SpringBootConfiguration</code>: Designates this class as a
configuration class. This annotation is a specialized form of the
<code>@Configuration</code> annotation.</li>
<li><code>@EnableAutoConfiguration</code>: Enables Spring Boot automatic
configuration. On a high level, this annotation tells Spring Boot to
automatically configure any components that it thinks you’ll need.</li>
<li><code>@XomponentScan</code>: Enables component scanning. This lets
you declare other classes with annotations like <code>@Component,
@Controller, @Service</code>, and others, to have Spring automatically
discover them and register them as components in the Spring application
context.</li>
</ul>
<p>The <code>main()</code> method calls a static <code>run()</code>
method on the SpringApplicaiton class, which performs the actual
bootstrapping of the application, creating the Spring application
context.</p>
<p>The <code>@SpringBootTest</code> annotation tells JUnit to bootstrap
the test with Spring Boot capabilities. Just like
<code>SpringBootApplicaiton</code>, <code>@SpringBootTest</code> is a
composite annotation, which itself annotated with
<code>@ExtendWith(SpringExtension.class)</code>, to add Spring testing
capabilities to Unit 5. For now, though, it’s enough to think of this as
the test class equivalent of calling
<code>SpringApplication.run()</code> in a <code>main()</code>
method.</p>
<h2 id="spring-mvc">Spring MVC</h2>
<p>At the center of Spring MVC is the concept of a
<code>controller</code>, a class that handles requests and responds with
information of some sort. In the case of a browser-facing application, a
controller responds by optionally populating model data and passing the
request on to a view to produce HTML that’s returned to the browser.</p>
<p>On its own, <code>@Controller</code> doesn’t do much. Its primary
purpose is to identify this class as a component for component scanning.
Because the HomeConroller class is annotated with
<code>@Controller</code>, Spring’s component scanning automatically
discovers it and creates an instance of HomeController as a bean in the
Spring application context. In fact, a handful of other annotations
(including <code>@Component, @Service,</code> and
<code>@Repository</code>) serve a purpose similar to
<code>@Controller</code>.</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication; </span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication; <span class="meta">@SpringBootApplication</span> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TacoCloudApplication</span> {</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> {</span><br><span class="line">		SpringApplication.run(TacoCloudApplication.class, args);</span><br><span class="line">	} </span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>The home() method is annotated with <code>@GetMapping</code> to
indicate that if an HTTP GET request is received for the root path
<code>/</code>, then this method should handle that request. It returns
a String value, which is interpreted as the logical name of a view. The
template name is derived from the logical view name by prefixing it with
/templates/ and postfixing it with .html.
(“home”–&gt;/templates/home.html).</p>
<h3 id="testing-the-controller">Testing the controller</h3>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebMvcTest(HomeController.class)</span> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HomeControllerTest</span> {</span><br><span class="line">	<span class="meta">@Autowired</span> <span class="keyword">private</span> MockMvc mockMvc;</span><br><span class="line">	<span class="meta">@Test</span> </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testHomePage</span><span class="params">()</span> <span class="keyword">throws</span> Exception { </span><br><span class="line">    mockMvc.perform(get(<span class="string">"/"</span>)) </span><br><span class="line">      .andExpect(status().isOk()) </span><br><span class="line">      .andExpect(view().name(<span class="string">"home"</span>)) </span><br><span class="line">      .andExpect(content().string( containsString(<span class="string">"Welcome to..."</span>))); </span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><em>HomeControllerTest</em> is annotated with
<code>@WebMvcTest</code>. This is a special test annotation provided by
Spring Boot that arranges for the test to run in the context of a Spring
MVC application. More specifically, in this case, it arranges for
<em>HomeController</em> to be registered in Spring MVC so that you can
throw requests against it.</p>
<p><code>@WebMvcTest</code> also sets up Spring support for testing
Spring MVC. Although it could be made to start a server, mocking the
mechanics of Spring MVC is sufficient for your purposes. The test class
is injected with a <em>MockMvc</em> object for the test to drive the
mockup.</p>
<p>By default, template options such as Thymeleaf and FreeMarker are
configured to cache the results of template parsing so that templates
don’t need to be reparsed with every request they serve.</p>
<h3 id="spring-mvc-auto-configuration">Spring MVC Auto
Configuration</h3>
<p>In the pom.xml file, you declared a dependency on the Web and
Thymeleaf starters. These two dependencies transitively brought in a
handful of other dependencies, including</p>
<ul>
<li>Spring’s MVC framework</li>
<li>Embedded Tomcat</li>
<li>Thymeleaf and the Thymeleaf layout dialect</li>
</ul>
<p>It also brought Spring Boot’s autoconfiguration library along for the
ride. When the application starts, Spring Boot autoconfiguration detects
those libraries and automatically</p>
<ul>
<li>Configures the beans in the Spring application context to enable
Spring MVC</li>
<li>Configures the embedded Tomcat server in the Spring application
context</li>
<li>Configures a Thymeleaf view resolver for rendering Spring MVC views
with Thymeleaf templates</li>
</ul>
<p>In short, autoconfiguration does all the grunt work, leaving you to
focus on writing code that implements your application
functionality.</p>
<h1 id="ch2-a-simple-web-app">Ch2 A Simple Web App</h1>
<p>In a Spring web application, it’s a controller’s job to fetch and
process data. And it’s a view’s job to render that data into HTML that
will be displayed in the browser.</p>
<img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/reading-notes/cqNotes/SoftwareDev/SpringInAction/spring-in-action-notes-01/ch2_simpleTaco.png" class="" title="The Spring MVC request flow for the simple TacoCloud app.">
<ul>
<li>A domain class that defines the properties of a taco ingredient</li>
<li>A Spring MVC controller class that fetches ingredient information
and passes it along to the view</li>
<li>A view template that renders a list of ingredients in the user’s
browser</li>
</ul>
<h2 id="establishing-the-domain">1. Establishing the domain</h2>
<p>An application’s domain is the subject area that it addresses—the
ideas and concepts that influence the understanding of the
application.</p>
<p>You’re using an amazing library called Lombok to automatically
generate those methods at compile-time so that they will be available at
runtime. In fact, the <code>@Data</code> annotation at the class level
is provided by Lombok and tells Lombok to generate all of those missing
methods as well as a constructor that accepts all final properties as
arguments.</p>
<p>This dependency will provide you with Lombok annotations (such as
<code>@Data</code>) at development time and with automatic method
generation at compile-time.</p>
<h2 id="creating-a-controller-class">2. Creating a controller class</h2>
<p>Controllers are the major players in Spring’s MVC framework. Their
primary job is to handle HTTP requests and either hand a request off to
a view to render HTML (browser-displayed) or write data directly to the
body of a response (RESTful).</p>
<p>The next annotation applied to <em>DesignTacoController</em> is
<code>@Controller</code>. This annotation serves to identify this class
as a controller and to mark it as a candidate for component scanning, so
that Spring will discover it and automatically create an instance of
<em>DesignTacoController</em> as a bean in the Spring application
context.</p>
<p><em>DesignTacoController</em> is also annotated with
<code>@RequestMapping</code>. The <code>@RequestMapping</code>
annotation, when applied at the class level, specifies the kind of
requests that this controller handles. In this case, it specifies that
<em>DesignTacoController</em> will handle requests whose path begins
with <code>/design</code>.</p>
<h3 id="handling-a-get-request">Handling a GET REQUEST</h3>
<p>The class-level <code>@RequestMapping</code> specification is refined
with the <code>@GetMapping</code> annotation that adorns the
<code>showDesignForm()</code> method. <code>@GetMapping</code>, paired
with the class-level <code>@RequestMapping</code>, specifies that when
an <code>HTTP GET</code> request is received for <code>/design</code>,
<code>showDesignForm()</code> will be called to handle the request.</p>
<p><code>@GetMapping</code> is just one member of a family of
request-mapping annotations.</p>
<table>
<thead>
<tr class="header">
<th>Annotation</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>@RequestMapping</code></td>
<td>General-purpose request handling</td>
</tr>
<tr class="even">
<td><code>GetMapping</code></td>
<td>Handles <code>HTTP GET</code> requests</td>
</tr>
<tr class="odd">
<td><code>PostMapping</code></td>
<td>Handles <code>HTTP POST</code> requests</td>
</tr>
<tr class="even">
<td><code>PutMapping</code></td>
<td>Handles <code>HTTP PUT</code> requests</td>
</tr>
<tr class="odd">
<td><code>DeleteMapping</code></td>
<td>Handles <code>HTTP DELETE</code> requests</td>
</tr>
<tr class="even">
<td><code>PatchMapping</code></td>
<td>Handles <code>HTTP PATCH</code> requests</td>
</tr>
</tbody>
</table>
<p><code>Model</code> is an object that ferries data between a
controller and whatever view is charged with rendering that data.
Ultimately, data that’s placed in Model attributes is copied into the
servlet request attributes, where the view can find them and use them to
render a page in the user’s browser.</p>
<h2 id="designing-the-view">3. Designing the view</h2>
<p>At runtime, Spring Boot autoconfiguration will see that Thymeleaf is
in the classpath and will automatically create the beans that support
Thymeleaf views for Spring MVC.</p>
<p>View libraries such as Thymeleaf are designed to be decoupled from
any particular web framework. As such, they’re unaware of Spring’s
<code>model</code> abstraction and are unable to work with the data that
the controller places in Model. But they can work with
<code>servlet</code> request attributes. Therefore, before Spring hands
the request over to a view, it copies the model data into request
attributes that Thymeleaf and other view-templating options have ready
access to.</p>
<p>Thymeleaf templates are just HTML with some additional element
attributes that guide a template in rendering request data. For example,
if there were a request attribute whose key is "message", and you wanted
it to be rendered into an HTML <code>&lt;p&gt;</code> tag by Thymeleaf,
you’d write the following in your Thymeleaf template:</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"${message}"</span>&gt;</span>placeholder message<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>When the template is rendered into HTML, the body of the
<code>&lt;p&gt;</code> element will be replaced with the value of the
servlet request attribute whose key is "message". The
<code>th:text</code>attribute is a Thymeleaf-namespaced attribute that
performs the replacement. The <code>${}</code> operator tells it to use
the value of a request attribute ("message", in this case).</p>
<h2 id="processing-form-submission">Processing form submission</h2>
<p>If you take another look at the <code>&lt;form&gt;</code> tag in your
view, you can see that its method attribute is set to POST. Moreover,
the <code>&lt;form&gt;</code> doesn’t declare an action attribute. This
means that when the form is submitted, the browser will gather up all
the data in the form and send it to the server in an HTTP POST request
to the same path for which a GET request displayed the form—the
<code>/design</code> path.</p>
<p>Therefore, you need a controller handler method on the receiving end
of that POST request. You need to write a new handler method in
<em>DesignTacoController</em> that handles a POST request for
<code>/design</code>.</p>
<p>As applied to the <code>processTaco()</code> method,
<code>@PostMapping</code> coordinates with the class-level</p>
<p><code>@RequestMapping</code> to indicate that
<code>processTaco()</code> should handle POST requests for
<code>/design</code>.</p>
<p>When the form is submitted, the fields in the form are bound to
properties of a Taco object (whose class is shown in the next listing)
that’s passed as a parameter into <code>processTaco()</code>. From
there, the <code>processTaco()</code> method can do whatever it wants
with the Taco object.</p>
<p>That’s where a <code>converter</code> comes in handy. A
<code>converter</code> is any class that implements Spring’s
<code>Converter</code> interface and implements its
<code>convert()</code> method to take one value and convert it to
another.</p>
<p>But what’s different is that the value returned from
<code>processTaco()</code> is prefixed with <code>redirect:</code>,
indicating that this is a redirect view. More specifically, it indicates
that after processTaco() completes, the user’s browser should be
redirected to the relative path <code>/orders/current</code>.</p>
<p>Without an action specified, the form would submit an HTTP POST
request back to the same URL that presented the form. But here, you
specify that the form should be POSTed to <code>/orders</code> (using
Thymeleaf’s <code>@{…}</code> operator for a context-relative path).</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns</span>=<span class="string">"http://www.w3.org/1999/xhtml"</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Taco Cloud<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">th:href</span>=<span class="string">"@{/styles.css}"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">"POST"</span> <span class="attr">th:action</span>=<span class="string">"@{/orders}"</span> <span class="attr">th:object</span>=<span class="string">"${tacoOrder}"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">h1</span>&gt;</span>Order your taco creations!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">img</span> <span class="attr">th:src</span>=<span class="string">"@{/images/TacoCloud.png}"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@{/design}"</span> <span class="attr">id</span>=<span class="string">"another"</span>&gt;</span>Design another taco<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">h3</span>&gt;</span>Deliver my taco masterpieces to...<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">      </span><br><span class="line">			<span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"deliveryName"</span>&gt;</span>Name: <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">th:field</span>=<span class="string">"*{deliveryName}"</span>/&gt;</span>	</span><br><span class="line">			<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">      ...</span><br><span class="line">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"Submit Order"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">form</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<h2 id="validating-form-input">Validating form input</h2>
<p>Fortunately, Spring supports Java’s Bean Validation API (also known
as JSR-303; https://jcp.org/en/jsr/detail?id=303). This makes it easy to
declare validation rules as opposed to explicitly writing declaration
logic in your application code.</p>
<p>The Validation API offers several annotations that can be placed on
properties of domain objects to declare validation rules. Hibernate’s
implementation of the Validation API adds even more validation
annotations. Both can be added to a project by adding the Spring
Validation starter to the build.</p>
<p>Finally, the ccCVV property is annotated with <code>@Digits</code> to
ensure that the value contains exactly three numeric digits.</p>
<p>All of the validation annotations include a <code>message</code>
attribute that defines the message you’ll display to the user if the
information they enter doesn’t meet the requirements of the declared
validation rules.</p>
<p>Now that you’ve declared how a <code>Taco</code> and
<code>TacoOrder</code> should be validated, we need to revisit each of
the controllers, specifying that validation should be performed when the
forms are POSTed to their respective handler methods.</p>
<p>To validate a submitted <code>Taco</code>, you need to add the Java
Bean Validation API’s <code>@Valid</code> annotation to the
<code>Taco</code> argument of DesignTacoController’s
<code>processTaco()</code> method.</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping</span> </span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">processTaco</span><span class="params">(<span class="meta">@Valid</span> <span class="meta">@ModelAttribute("taco")</span> Taco taco, Errors errors)</span> { <span class="keyword">if</span> (errors.hasErrors()) { <span class="keyword">return</span> <span class="string">"design"</span>; }</span><br><span class="line"></span><br><span class="line"><span class="comment">// Save the taco...</span></span><br><span class="line"><span class="comment">// We'll do this in chapter 3 log.info("Processing taco: " + taco);</span></span><br><span class="line"><span class="keyword">return</span> <span class="string">"redirect:/orders/current"</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>The <code>@Valid</code> annotation tells Spring MVC to perform
validation on the submitted <code>Taco</code> object after it’s bound to
the submitted form data and before the <code>processTaco()</code> method
is called. If there are any validation errors, the details of those
errors will be captured in an <code>Errors</code> object that’s passed
into <code>processTaco()</code>. The first few lines of
<code>processTaco()</code> consult the <code>Errors</code> object,
asking its <code>hasErrors()</code> method if there are any validation
errors. If there are, the method concludes without processing the
<code>Taco</code> and returns the "design" view name so that the form is
redisplayed.</p>
<p>Thymeleaf offers convenient access to the <code>Errors</code> object
via the <code>fields</code> property and with its <code>th:errors</code>
attribute. For example, to display validation errors on the credit card
number field, you can add a <code>&lt;span&gt;</code> element that uses
these error references to the order form template, as follows.</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"ccNumber"</span>&gt;</span>Credit Card #: <span class="tag">&lt;/<span class="name">label</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">th:field</span>=<span class="string">"*{ccNumber}"</span>/&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"validationError"</span></span></span><br><span class="line"><span class="tag">			<span class="attr">th:if</span>=<span class="string">"${#fields.hasErrors('ccNumber')}"</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">th:errors</span>=<span class="string">"*{ccNumber}"</span>&gt;</span>CC Num Error<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>Aside from a class attribute that can be used to style the error so
that it catches the user’s attention, the <code>&lt;span&gt;</code>
element uses a th:if attribute to decide whether or not to display the
<code>&lt;span&gt;</code>. The fields property’s
<code>hasErrors()</code> method checks if there are any errors in the
<code>ccNumber</code> field. If so, the <code>&lt;span&gt;</code> will
be rendered.</p>
<p>Although each controller serves a distinct purpose in the
functionality of the application, they all pretty much follow the same
programming model:</p>
<ul>
<li><p>They’re all annotated with <code>@Controller</code> to indicate
that they’re controller classes that should be automatically discovered
by Spring component scanning and instantiated as beans in the Spring
application context.</p></li>
<li><p>All but HomeController are annotated with
<code>@RequestMapping</code> at the class level to define a baseline
request pattern that the controller will handle.</p></li>
<li><p>They all have one or more methods that are annotated with
<code>@GetMapping</code> or <code>@PostMapping</code> to provide
specifics on which methods should handle which kinds of
requests.</p></li>
</ul>
<h1 id="code-files">Code Files</h1>
<p><code>HomeController.java</code></p>

<h3 id="domain">Domain</h3>
<p><code>domain/Ingredient.java</code></p>

<p><code>domain/Taco.java</code></p>

<p><code>TacoOrder</code></p>

<h3 id="web">Web</h3>
<p><code>DesignTacoController.java</code></p>

<p><code>IngredientByIdConverter.java</code></p>

<p><code>OrderController.java</code></p>

<h2 id="section"></h2>
<h2 id="code-tabs">Code tabs</h2>
<p></p><div class="tabs" id="web"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#web-1">OrderController</button></li><li class="tab"><button type="button" data-href="#web-2">IngredientByIdConverter</button></li><li class="tab"><button type="button" data-href="#web-3">DesignTacoController</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="web-1"><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping("/orders")</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderController</span></span><br><span class="line">{</span><br><span class="line">    <span class="meta">@GetMapping("/current")</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">orderForm</span><span class="params">(Model model)</span></span><br><span class="line">    {</span><br><span class="line">        model.addAttribute(<span class="string">"tacoOrder"</span>, <span class="keyword">new</span> <span class="title class_">TacoOrder</span>());</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"orderForm"</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">processOrder</span><span class="params">(<span class="meta">@Valid</span> TacoOrder order, Errors errors)</span></span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span>(errors.hasErrors())</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"orderForm"</span>;</span><br><span class="line">        log.info(<span class="string">"Order submitted: "</span>+order);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"redirect:/"</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="web-2"><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IngredientByIdConverter</span> <span class="keyword">implements</span> <span class="title class_">Converter</span>&lt;String, Ingredient&gt;</span><br><span class="line">{</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, Ingredient&gt; ingredientMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">IngredientByIdConverter</span><span class="params">()</span></span><br><span class="line">    {</span><br><span class="line">        ingredientMap.put(<span class="string">"FLTO"</span>,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Ingredient</span>(<span class="string">"FLTO"</span>, <span class="string">"Flour Tortilla"</span>, IngredientType.WRAP));</span><br><span class="line">        ingredientMap.put(<span class="string">"COTO"</span>,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Ingredient</span>(<span class="string">"COTO"</span>, <span class="string">"Corn Tortilla"</span>, IngredientType.WRAP));</span><br><span class="line">        ingredientMap.put(<span class="string">"GRBF"</span>,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Ingredient</span>(<span class="string">"GRBF"</span>, <span class="string">"Ground Beef"</span>, IngredientType.PROTEIN));</span><br><span class="line">        ingredientMap.put(<span class="string">"CARN"</span>,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Ingredient</span>(<span class="string">"CARN"</span>, <span class="string">"Carnitas"</span>, IngredientType.PROTEIN));</span><br><span class="line">        ingredientMap.put(<span class="string">"TMTO"</span>,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Ingredient</span>(<span class="string">"TMTO"</span>, <span class="string">"Diced Tomatoes"</span>, IngredientType.VEGGIES));</span><br><span class="line">        ingredientMap.put(<span class="string">"LETC"</span>,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Ingredient</span>(<span class="string">"LETC"</span>, <span class="string">"Lettuce"</span>, IngredientType.VEGGIES));</span><br><span class="line">        ingredientMap.put(<span class="string">"CHED"</span>,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Ingredient</span>(<span class="string">"CHED"</span>, <span class="string">"Cheddar"</span>, IngredientType.CHEESE));</span><br><span class="line">        ingredientMap.put(<span class="string">"JACK"</span>,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Ingredient</span>(<span class="string">"JACK"</span>, <span class="string">"Monterrey Jack"</span>, IngredientType.CHEESE));</span><br><span class="line">        ingredientMap.put(<span class="string">"SLSA"</span>,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Ingredient</span>(<span class="string">"SLSA"</span>, <span class="string">"Salsa"</span>, IngredientType.SAUCE));</span><br><span class="line">        ingredientMap.put(<span class="string">"SRCR"</span>,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Ingredient</span>(<span class="string">"SRCR"</span>, <span class="string">"Sour Cream"</span>, IngredientType.SAUCE));    }</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Ingredient <span class="title function_">convert</span><span class="params">(String id)</span></span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">return</span> ingredientMap.get(id);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="web-3"><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping("/design")</span></span><br><span class="line"><span class="meta">@SessionAttributes("tacoOrder")</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DesignTacoController</span></span><br><span class="line">{</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The lombok annotation <span class="doctag">@Slf</span>4j has the same effect as</span></span><br><span class="line"><span class="comment">     * //    private static final org.slf4j.Logger log =</span></span><br><span class="line"><span class="comment">     *          org.slf4j.LoggerFactory.getLogger(DesignTacoController.class);</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Controller</span> serves to identify this class as a controller and to mark</span></span><br><span class="line"><span class="comment">     * it as a candidate for component scanning, so that Spring</span></span><br><span class="line"><span class="comment">     * will discover it and automatically create an instance of</span></span><br><span class="line"><span class="comment">     * DesignTacoController as a bean in the Spring application context.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@RequestMapping</span> annotation, when applied at teh class level, specifies</span></span><br><span class="line"><span class="comment">     * the kind of requests that this controller handles.</span></span><br><span class="line"><span class="comment">     * In this case, it specifies that DesignTacoController will handle requests</span></span><br><span class="line"><span class="comment">     * whose path begins with /design</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@GetMapping</span>, paired witht eh class level <span class="doctag">@RequestMapping</span>, specifies that when</span></span><br><span class="line"><span class="comment">     * an HTTP GET request is received for /design, showDesignForm() will be called to</span></span><br><span class="line"><span class="comment">     * handle the request. it returns a String value of "design", which is the</span></span><br><span class="line"><span class="comment">     * logical name of the view that will be used to render the model to the browser.</span></span><br><span class="line"><span class="comment">     * Model is an object that ferries data between a controller and whatever</span></span><br><span class="line"><span class="comment">     * view is charged with rendering that data. Ultimately, data that's placed</span></span><br><span class="line"><span class="comment">     * in Model attributes is copied into the servlet request attributes, where the view</span></span><br><span class="line"><span class="comment">     * can find them and use them to render a page in the user's browser.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="comment">// the &lt;form&gt; doesn't declare an action attribute. This means that when the</span></span><br><span class="line">    <span class="comment">// form is submitted, the browser will gather up all the data in the form</span></span><br><span class="line">    <span class="comment">//and send it to the server in an HTTP POST request to the same path for which a</span></span><br><span class="line">    <span class="comment">// GET request displayedd the form: the /design path</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">showDesignForm</span><span class="params">(Model model)</span></span><br><span class="line">    {</span><br><span class="line">        model.addAttribute(<span class="string">"taco"</span>,<span class="keyword">new</span> <span class="title class_">Taco</span>());</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"design"</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">//When the form is submitted, the fields in the form are bound to properties of</span></span><br><span class="line">    <span class="comment">// a Taco object, that's passed as a parameter into processtaco()</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">processTaco</span><span class="params">(Taco taco)</span></span><br><span class="line">    {</span><br><span class="line">        <span class="comment">//Save the taco</span></span><br><span class="line">        log.info(<span class="string">"Processing tacl: "</span>+taco);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"redirect: /orders/current"</span>;</span><br><span class="line">        <span class="comment">//redirect indicating that this is a redict view.</span></span><br><span class="line">        <span class="comment">//more specifically, it indicates that after processTaco()</span></span><br><span class="line">        <span class="comment">// completes, the user's browser shoudl be redirected to the</span></span><br><span class="line">        <span class="comment">// relative path /orders/current</span></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@ModelAttribute</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addIngredientsToModel</span><span class="params">(Model model)</span></span><br><span class="line">    {</span><br><span class="line">        List&lt;Ingredient&gt; ingredients = Arrays.asList(</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Ingredient</span>(<span class="string">"COTO"</span>, <span class="string">"Corn Tortilla"</span>, IngredientType.WRAP),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Ingredient</span>(<span class="string">"GRBF"</span>, <span class="string">"Ground Beef"</span>, IngredientType.PROTEIN),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Ingredient</span>(<span class="string">"CARN"</span>, <span class="string">"Carnitas"</span>, IngredientType.PROTEIN),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Ingredient</span>(<span class="string">"TMTO"</span>, <span class="string">"Diced Tomatoes"</span>, IngredientType.VEGGIES),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Ingredient</span>(<span class="string">"LETC"</span>, <span class="string">"Lettuce"</span>, IngredientType.VEGGIES),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Ingredient</span>(<span class="string">"CHED"</span>, <span class="string">"Cheddar"</span>, IngredientType.CHEESE),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Ingredient</span>(<span class="string">"JACK"</span>, <span class="string">"Monterrey Jack"</span>, IngredientType.CHEESE),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Ingredient</span>(<span class="string">"SLSA"</span>, <span class="string">"Salsa"</span>, IngredientType.SAUCE),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Ingredient</span>(<span class="string">"SRCR"</span>, <span class="string">"Sour Cream"</span>, IngredientType.SAUCE)</span><br><span class="line">        );</span><br><span class="line">        IngredientType[] types = IngredientType.values();</span><br><span class="line">        <span class="keyword">for</span>(IngredientType type: types)</span><br><span class="line">        {</span><br><span class="line">            model.addAttribute(type.toString().toLowerCase(),filterByType(ingredients, type));</span><br><span class="line">        }</span><br><span class="line">        log.info(<span class="string">"Added {} ingredients"</span>, ingredients.size());</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Iterable&lt;Ingredient&gt; <span class="title function_">filterByType</span><span class="params">(List&lt;Ingredient&gt; ingredients, IngredientType type)</span></span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">return</span> ingredients.stream()</span><br><span class="line">                .filter(ingredient -&gt; ingredient.getType().equals(type))</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p></p>
<script type="text&#x2F;javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.7.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.7.0/dist/mindmap.min.css"></article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/reading-notes/tags/software-dev/">software_dev</a><a class="post-meta__tags" href="/reading-notes/tags/spring/">spring</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/reading-notes/cqNotes/SoftwareDev/SpringInAction/spring-in-action-notes-02/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/reading-notes/default_cover/typewriter-801921_1920.jpg" onerror="onerror=null;src='/reading-notes/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Spring In Action Notes (2)</div></div></a></div><div class="next-post pull-right"><a href="/reading-notes/cqNotes/Java/cq_java_review/"><img class="next-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/reading-notes/default_cover/sunflowers-7112463_1280.jpg" onerror="onerror=null;src='/reading-notes/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">cq_java_review</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/reading-notes/cqNotes/SoftwareDev/SpringInAction/spring-in-action-notes-07/" title="Spring In Action Notes (7)"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/reading-notes/default_cover/toucan-4185361_1280.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-01</div><div class="title">Spring In Action Notes (7)</div></div></a></div><div><a href="/reading-notes/cqNotes/SoftwareDev/SpringInAction/spring-in-action-notes-06/" title="Spring In Action Notes (6)"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/reading-notes/default_cover/circles-5444818_1280.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-29</div><div class="title">Spring In Action Notes (6)</div></div></a></div><div><a href="/reading-notes/cqNotes/SoftwareDev/SpringInAction/spring-in-action-notes-04/" title="Spring In Action Notes (4)"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/reading-notes/default_cover/circles-5444818_1280.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-28</div><div class="title">Spring In Action Notes (4)</div></div></a></div><div><a href="/reading-notes/cqNotes/SoftwareDev/SpringInAction/spring-in-action-notes-03/" title="Spring In Action Notes (3)"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/reading-notes/default_cover/watercolor-7000531_1280.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-28</div><div class="title">Spring In Action Notes (3)</div></div></a></div><div><a href="/reading-notes/cqNotes/SoftwareDev/SpringInAction/spring-in-action-notes-02/" title="Spring In Action Notes (2)"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/reading-notes/default_cover/typewriter-801921_1920.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-27</div><div class="title">Spring In Action Notes (2)</div></div></a></div><div><a href="/reading-notes/cqNotes/Java/cq_springboot/" title="cq_sprintboot"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/reading-notes/default_cover/microsoft-edge-mt4xBHKxFH4-unsplash.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-01-01</div><div class="title">cq_sprintboot</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ch1-getting-started"><span class="toc-number">1.</span> <span class="toc-text">Ch1 Getting Started</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#what-is-spring"><span class="toc-number">1.1.</span> <span class="toc-text">What is Spring</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#spring-mvc"><span class="toc-number">1.2.</span> <span class="toc-text">Spring MVC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#testing-the-controller"><span class="toc-number">1.2.1.</span> <span class="toc-text">Testing the controller</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#spring-mvc-auto-configuration"><span class="toc-number">1.2.2.</span> <span class="toc-text">Spring MVC Auto
Configuration</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ch2-a-simple-web-app"><span class="toc-number">2.</span> <span class="toc-text">Ch2 A Simple Web App</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#establishing-the-domain"><span class="toc-number">2.1.</span> <span class="toc-text">1. Establishing the domain</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#creating-a-controller-class"><span class="toc-number">2.2.</span> <span class="toc-text">2. Creating a controller class</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#handling-a-get-request"><span class="toc-number">2.2.1.</span> <span class="toc-text">Handling a GET REQUEST</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#designing-the-view"><span class="toc-number">2.3.</span> <span class="toc-text">3. Designing the view</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#processing-form-submission"><span class="toc-number">2.4.</span> <span class="toc-text">Processing form submission</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#validating-form-input"><span class="toc-number">2.5.</span> <span class="toc-text">Validating form input</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#code-files"><span class="toc-number">3.</span> <span class="toc-text">Code Files</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#domain"><span class="toc-number">3.0.1.</span> <span class="toc-text">Domain</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web"><span class="toc-number">3.0.2.</span> <span class="toc-text">Web</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#section"><span class="toc-number">3.1.</span> <span class="toc-text"></span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#code-tabs"><span class="toc-number">3.2.</span> <span class="toc-text">Code tabs</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="Increase font size"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="Decrease font size"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/reading-notes/js/utils.js"></script><script src="/reading-notes/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/reading-notes/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      false && mermaid.init()
    })
  }
}</script></div></div><!-- hexo injector body_end start --><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><!-- hexo injector body_end end --></body></html>