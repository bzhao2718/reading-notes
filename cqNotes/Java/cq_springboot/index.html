<!DOCTYPE html><html class="hide-aside" lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>cq_sprintboot | ReadingNotes</title><meta name="keywords" content="software_dev,spring"><meta name="author"><meta name="copyright"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Spring Boot REST Hello World REST API What is a REST API? A REST API (aka. RESTful API) is an application programming interface (API or web API) that conforms to the constraints of REST architectural">
<meta property="og:type" content="article">
<meta property="og:title" content="cq_sprintboot">
<meta property="og:url" content="https://bzhao2718.github.io/reading-notes/cqNotes/Java/cq_springboot/index.html">
<meta property="og:site_name" content="ReadingNotes">
<meta property="og:description" content="Spring Boot REST Hello World REST API What is a REST API? A REST API (aka. RESTful API) is an application programming interface (API or web API) that conforms to the constraints of REST architectural">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://bzhao2718.github.io/reading-notes/default_cover/abstract-1264071.svg">
<meta property="article:published_time" content="2021-01-01T06:02:14.000Z">
<meta property="article:modified_time" content="2021-11-26T02:57:48.871Z">
<meta property="article:tag" content="software_dev">
<meta property="article:tag" content="spring">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://bzhao2718.github.io/reading-notes/default_cover/abstract-1264071.svg"><link rel="shortcut icon" href="/reading-notes/img/favicon.png"><link rel="canonical" href="https://bzhao2718.github.io/reading-notes/cqNotes/Java/cq_springboot/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/reading-notes/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/reading-notes/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":500},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'cq_sprintboot',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-11-26 10:57:48'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://unpkg.zhimg.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/hexo-butterfly-tag-plugins-plus@latest/lib/carousel-touch.min.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.2.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/reading-notes/archives/"><div class="headline">Articles</div><div class="length-num">86</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/reading-notes/tags/"><div class="headline">Tags</div><div class="length-num">22</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/reading-notes/categories/"><div class="headline">Categories</div><div class="length-num">12</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/reading-notes/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/reading-notes/">ReadingNotes</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/reading-notes/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/reading-notes/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">cq_sprintboot</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2021-01-01T06:02:14.000Z" title="Created 2021-01-01 14:02:14">2021-01-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2021-11-26T02:57:48.871Z" title="Updated 2021-11-26 10:57:48">2021-11-26</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>29min</span></span></div></div></div><article class="post-content" id="article-container"><h2 id="spring-boot-rest-hello-world">Spring Boot REST Hello World</h2>
<h2 id="rest-api">REST API</h2>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.redhat.com/en/topics/api/what-is-a-rest-api">What is a REST API?</a></p>
<p>A REST API (aka. RESTful API) is an application programming interface (API or web API) that conforms to the constraints of REST architectural style and allows for interaction with RESTful web services.</p>
<p>An API is a set of definitions and protocols for building and integrating application software. It’s sometimes referred to as a contract between an information provider and an information user—establishing the content required from the consumer (the call) and the content required by the producer (the response). For example, the API design for a weather service could specify that the user supply a zip code and that the producer reply with a 2-part answer, the first being the high temperature, and the second being the low.</p>
<p>In other words, if you want to interact with a computer or system to retrieve information or perform a function, an API helps you communicate what you want to that system so it can understand and fulfill the request. You can think of an API as a mediator between the users or clients and the resources or web services they want to get. It’s also a way for an organization to share resources and information while maintaining security, control, and authentication—determining who gets access to what.</p>
<p>REST is a set of architectural constraints, not a protocol or a standard. API developers can implement REST in a variety of ways.</p>
<p>When a client request is made via a RESTful API, it transfers a representation of the state of the resource to the requester or endpoint. This information, or representation, is delivered in one of several formats via HTTP: JSON (Javascript Object Notation), HTML, XLT, Python, PHP, or plain text. JSON is the most generally popular file format to use because, despite its name, it’s language-agnostic, as well as readable by both humans and machines.</p>
<p>Something else to keep in mind: Headers and parameters are also important in the HTTP methods of a RESTful API HTTP request, as they contain important identifier information as to the request's metadata, authorization, uniform resource identifier (URI), caching, cookies, and more. There are request headers and response headers, each with their own HTTP connection information and status codes.</p>
<p>In order for an API to be considered RESTful, it has to conform to these criteria:</p>
<ul>
<li>A client-server architecture made up of clients, servers, and resources, with requests managed through HTTP.</li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.redhat.com/en/topics/cloud-native-apps/stateful-vs-stateless">Stateless</a> client-server communication, meaning no client information is stored between get requests and each request is separate and unconnected.</li>
<li>Cacheable data that streamlines client-server interactions.</li>
<li>A uniform interface between components so that information is transferred in a standard form. This requires that:
<ul>
<li>resources requested are identifiable and separate from the representations sent to the client.</li>
<li>resources can be manipulated by the client via the representation they receive because the representation contains enough information to do so.</li>
<li>self-descriptive messages returned to the client have enough information to describe how the client should process it.</li>
<li>hypertext/hypermedia is available, meaning that after accessing a resource the client should be able to use hyperlinks to find all other currently available actions they can take.</li>
</ul></li>
<li>A layered system that organizes each type of server (those responsible for security, load-balancing, etc.) involved the retrieval of requested information into hierarchies, invisible to the client.</li>
<li>Code-on-demand (optional): the ability to send executable code from the server to the client when requested, extending client functionality.</li>
</ul>
<p>Though the REST API has these criteria to conform to, it is still considered easier to use than a prescribed protocol like SOAP (Simple Object Access Protocol), which has specific requirements like XML messaging, and built-in security and transaction compliance that make it slower and heavier.</p>
<p>In contrast, REST is a set of guidelines that can be implemented as needed, making REST APIs faster and more lightweight, with increased scalablity—perfect for <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.redhat.com/en/topics/internet-of-things">Internet of Things (IoT)</a> and <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.redhat.com/en/topics/mobile">mobile app development</a>.</p>
<h3 id="create-a-resource-representation-class">Create a Resource Representation Class</h3>
<p>To model the greeting representation, create a resource representation class. To do so, provide a plain old Java object with fields, constructors, and accessors for the <code>id</code> and <code>content</code> data, as the following listing.</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Greeting</span> {</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="type">long</span> id;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> String content;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">Greeting</span><span class="params">(<span class="type">long</span> id, String content)</span> {</span><br><span class="line">		<span class="built_in">this</span>.id = id;</span><br><span class="line">		<span class="built_in">this</span>.content = content;</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="type">long</span> <span class="title function_">getId</span><span class="params">()</span> {</span><br><span class="line">		<span class="keyword">return</span> id;</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">getContent</span><span class="params">()</span> {</span><br><span class="line">		<span class="keyword">return</span> content;</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="create-a-resource-controller">Create a Resource Controller</h3>
<p>In Spring’s approach to building RESTful web services, HTTP requests are handled by a controller. These components are identified by the <a target="_blank" rel="noopener external nofollow noreferrer" href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/bind/annotation/RestController.html"><code>@RestController</code></a> annotation, and the <code>GreetingController</code>shown in the following listing (from <code>src/main/java/com/example/restservice/GreetingController.java</code>) handles <code>GET</code> requests for <code>/greeting</code> by returning a new instance of the <code>Greeting</code> class</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GreetingController</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">template</span> <span class="operator">=</span> <span class="string">"Hello, %s!"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">AtomicLong</span> <span class="variable">counter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicLong</span>();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping("/greeting")</span></span><br><span class="line">    <span class="keyword">public</span> Greeting <span class="title function_">greeting</span><span class="params">(<span class="meta">@RequestParam(value="name",defaultValue="World")</span> String name)</span></span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Greeting</span>(counter.incrementAndGet(), String.format(template,name));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>The <code>@GetMapping</code> annotation ensures that HTTP GET requests to <code>/greeting</code> are mapped to the <code>greeting()</code> method.</p>
<blockquote>
<p>There are companion annotations for other HTTP verbs (e.g. <code>@PostMapping</code> for POST). There is also a <code>@RequestMapping</code>annotation that they all derive from, and can serve as a synonym (e.g. <code>@RequestMapping(method=GET)</code>).</p>
</blockquote>
<p><code>@RequestParam</code> binds the value of the query string parameter <code>name</code> into the <code>name</code> parameter of the <code>greeting()</code> method. If the <code>name</code> parameter is absent in the request, the <code>defaultValue</code> of <code>World</code> is used.</p>
<p>The implementation of the method body creates and returns a new <code>Greeting</code> object with <code>id</code> and <code>content</code> attributes based on the next value from the <code>counter</code> and formats the given <code>name</code> by using the greeting <code>template</code>.</p>
<p>A key difference between a traditional MVC controller and the RESTful web service controller shown earlier is the way that the HTTP response body is created. Rather than relying on a view technology to perform server-side rendering of the greeting data to HTML, this RESTful web service controller populates and returns a <code>Greeting</code> object. The object data will be written directly to the HTTP response as JSON.</p>
<p>This code uses Spring <a target="_blank" rel="noopener external nofollow noreferrer" href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/bind/annotation/RestController.html"><code>@RestController</code></a> annotation, which marks the class as a controller where every method returns a domain object instead of a view. It is shorthand for including both <code>@Controller</code> and <code>@ResponseBody</code>.</p>
<p>The <code>Greeting</code> object must be converted to JSON. Thanks to Spring’s HTTP message converter support, you need not do this conversion manually. Because <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/FasterXML/jackson">Jackson 2</a> is on the classpath, Spring’s <a target="_blank" rel="noopener external nofollow noreferrer" href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/http/converter/json/MappingJackson2HttpMessageConverter.html"><code>MappingJackson2HttpMessageConverter</code></a> is automatically chosen to convert the <code>Greeting</code> instance to JSON.</p>
<p><code>@SpringBootApplication</code> is a convenience annotation that adds all of the following:</p>
<ul>
<li><code>@Configuration</code>: Tags the class as a source of bean definitions for the application context.</li>
<li><code>@EnableAutoConfiguration</code>: Tells Spring Boot to start adding beans based on classpath settings, other beans, and various property settings. For example, if <code>spring-webmvc</code> is on the classpath, this annotation flags the application as a web application and activates key behaviors, such as setting up a <code>DispatcherServlet</code>.</li>
<li><code>@ComponentScan</code>: Tells Spring to look for other components, configurations, and services in the <code>com/example</code> package, letting it find the controllers.</li>
</ul>
<p>The <code>main()</code> method uses Spring Boot’s <code>SpringApplication.run()</code> method to launch an application. Did you notice that there was not a single line of XML? There is no <code>web.xml</code> file, either. This web application is 100% pure Java and you did not have to deal with configuring any plumbing or infrastructure.</p>
<h3 id="bild-an-executable-jar">Bild an executable JAR</h3>
<p>You can run the application from the command line with Gradle or Maven. You can also build a single executable JAR file that contains all the necessary dependencies, classes, and resources and run that. Building an executable jar makes it easy to ship, version, and deploy the service as an application throughout the development lifecycle, across different environments, and so forth.</p>
<p>If you use Maven, you can run the application by using <code>./mvnw spring-boot:run</code>. Alternatively, you can build the JAR file with <code>./mvnw clean package</code> and then run the JAR file, as follows:</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar target/gs-rest-service-0.1.0.jar</span><br></pre></td></tr></tbody></table></figure>
<h3 id="test-the-service">Test the service</h3>
<p>Now that the service is up, visit <code>http://localhost:8080/greeting</code>, where you should see:</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">{"id":1,"content":"Hello, World!"}</span><br></pre></td></tr></tbody></table></figure>
<p>Provide a <code>name</code> query string parameter by visiting <code>http://localhost:8080/greeting?name=User</code>. Notice how the value of the <code>content</code> attribute changes from <code>Hello, World!</code> to <code>Hello, User!</code>, as the following listing shows:</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">{"id":2,"content":"Hello, User!"}</span><br></pre></td></tr></tbody></table></figure>
<p>This change demonstrates that the <code>@RequestParam</code> arrangement in <code>GreetingController</code> is working as expected. The <code>name</code> parameter has been given a default value of <code>World</code> but can be explicitly overridden through the query string.</p>
<p>Notice also how the <code>id</code> attribute has changed from <code>1</code> to <code>2</code>. This proves that you are working against the same <code>GreetingController</code>instance across multiple requests and that its <code>counter</code> field is being</p>
<p>incremented on each call as expected.</p>
<h2 id="springboot-rest-example-different-layers">SpringBoot REST Example Different Layers</h2>
<img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/reading-notes/cqNotes/Java/cq_springboot/image-20210831123638857.png" class="">
<img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/reading-notes/cqNotes/Java/cq_springboot/image-20210831140724064.png" class="">
<p>{width=49%}</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"> api</span><br><span class="line">*/</span><br><span class="line"><span class="comment">//get, post(add), put(update), delete</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("api/v1/person")</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PersonController</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> PersonService personService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">PersonController</span><span class="params">(PersonService personService)</span></span><br><span class="line">    {</span><br><span class="line">        <span class="built_in">this</span>.personService = personService;</span><br><span class="line">    }</span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addPerson</span><span class="params">(<span class="meta">@Valid</span> <span class="meta">@NonNull</span> <span class="meta">@RequestBody</span> Person person)</span></span><br><span class="line">    {</span><br><span class="line">        <span class="comment">//@RequestBody, match person attributes, post body contains person</span></span><br><span class="line">        personService.addPerson(person);</span><br><span class="line">    }</span><br><span class="line">    <span class="meta">@GetMapping</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Person&gt; <span class="title function_">getAllPeople</span><span class="params">()</span></span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">return</span> personService.getAllPeople();</span><br><span class="line">    }</span><br><span class="line">    <span class="meta">@GetMapping(path="{id}")</span> <span class="comment">//{id} is grabbed and passed to the method</span></span><br><span class="line">    <span class="keyword">public</span> Person <span class="title function_">getPersonById</span><span class="params">(<span class="meta">@PathVariable("id")</span> UUID id)</span></span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">return</span> personService.getPersonById(id)</span><br><span class="line">                .orElse(<span class="literal">null</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="meta">@DeleteMapping(path="{id}")</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deletePersonById</span><span class="params">(<span class="meta">@PathVariable("id")</span> UUID id)</span></span><br><span class="line">    {</span><br><span class="line">        personService.deletePersonById(id);</span><br><span class="line">    }</span><br><span class="line">    <span class="meta">@PutMapping(path="{id}")</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updatePerson</span><span class="params">(<span class="meta">@PathVariable("id")</span> UUID id, <span class="meta">@Valid</span> <span class="meta">@NonNull</span> <span class="meta">@RequestBody</span> Person personToUpdate)</span></span><br><span class="line">    {</span><br><span class="line">        personService.updatePersonById(id,personToUpdate);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">dao</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">PersonDao</span></span><br><span class="line">{</span><br><span class="line">    <span class="comment">//we can switch different implementations of Dao access</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">insertPerson</span><span class="params">(UUID id, Person person)</span>;</span><br><span class="line"></span><br><span class="line">    Optional&lt;Person&gt; <span class="title function_">selectPersonById</span><span class="params">(UUID id)</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;Person&gt; <span class="title function_">selectAllPeople</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="title function_">deletePersonById</span><span class="params">(UUID id)</span>;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">updatePersonById</span><span class="params">(UUID id, Person updatedPerson)</span>;</span><br><span class="line"></span><br><span class="line">  	<span class="comment">//default keyword, specific classes implement this interface don't </span></span><br><span class="line">  	<span class="comment">//have to implement this method.</span></span><br><span class="line">    <span class="keyword">default</span> <span class="type">int</span> <span class="title function_">insertPerson</span><span class="params">(Person person)</span></span><br><span class="line">    {</span><br><span class="line">        <span class="type">UUID</span> <span class="variable">id</span> <span class="operator">=</span> UUID.randomUUID();</span><br><span class="line">        <span class="keyword">return</span> insertPerson(id, person);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository("fakeDao")</span> <span class="comment">//could be "mysql", "mongoDB", etc.</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FakePersonDataAccessService</span> <span class="keyword">implements</span> <span class="title class_">PersonDao</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Person&gt; personDb = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">insertPerson</span><span class="params">(UUID id, Person person)</span></span><br><span class="line">    {</span><br><span class="line">        personDb.add(<span class="keyword">new</span> <span class="title class_">Person</span>(id, person.getName()));</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Optional&lt;Person&gt; <span class="title function_">selectPersonById</span><span class="params">(UUID id)</span></span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">return</span> personDb.stream()</span><br><span class="line">                .filter(person -&gt; person.getId().equals(id))</span><br><span class="line">                .findFirst();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Person&gt; <span class="title function_">selectAllPeople</span><span class="params">()</span></span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">return</span> personDb;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">deletePersonById</span><span class="params">(UUID id)</span></span><br><span class="line">    {</span><br><span class="line">        Optional&lt;Person&gt; optionalPerson = selectPersonById(id);</span><br><span class="line">        <span class="keyword">if</span>(optionalPerson.isEmpty())</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        personDb.remove(optionalPerson.get());</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">updatePersonById</span><span class="params">(UUID id, Person updatedPerson)</span></span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">return</span> selectPersonById(id)</span><br><span class="line">                .map(person -&gt;</span><br><span class="line">                {</span><br><span class="line">                    <span class="type">int</span> <span class="variable">indexOfPersonToUpdate</span> <span class="operator">=</span> personDb.indexOf(person);</span><br><span class="line">                    <span class="keyword">if</span>(indexOfPersonToUpdate&gt;=<span class="number">0</span>)</span><br><span class="line">                    {</span><br><span class="line">                        personDb.set(indexOfPersonToUpdate, <span class="keyword">new</span> <span class="title class_">Person</span>(id, updatedPerson.getName()));</span><br><span class="line">                        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                    }</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                }).orElse(<span class="number">0</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">model</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> UUID id;</span><br><span class="line">    <span class="meta">@NotBlank</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(<span class="meta">@JsonProperty("id")</span> UUID id,</span></span><br><span class="line"><span class="params">                  <span class="meta">@JsonProperty("name")</span> String name)</span></span><br><span class="line">    {</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> UUID <span class="title function_">getId</span><span class="params">()</span></span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span></span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">service</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PersonService</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> PersonDao personDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">PersonService</span><span class="params">(<span class="meta">@Qualifier("fakeDao")</span> PersonDao personDao)</span></span><br><span class="line">    {</span><br><span class="line">        <span class="built_in">this</span>.personDao = personDao;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">addPerson</span><span class="params">(Person person)</span></span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">return</span> personDao.insertPerson(person);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">public</span> List&lt;Person&gt; <span class="title function_">getAllPeople</span><span class="params">()</span></span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">return</span> personDao.selectAllPeople();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Optional&lt;Person&gt; <span class="title function_">getPersonById</span><span class="params">(UUID id)</span></span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">return</span> personDao.selectPersonById(id);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">deletePersonById</span><span class="params">(UUID id)</span></span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">return</span> personDao.deletePersonById(id);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">updatePersonById</span><span class="params">(UUID id, Person person)</span></span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">return</span> personDao.updatePersonById(id, person);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RestExampleApplication</span> {</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> {</span><br><span class="line">		SpringApplication.run(RestExampleApplication.class, args);</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="building-rest-services-with-spring">Building REST services with Spring</h2>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://spring.io/guides/tutorials/rest/">Tutorial | Building REST services with Spring</a></p>
<p>The web and its core protocol, HTTP, provide a stack of features:</p>
<ul>
<li>Suitable actions (<code>GET</code>, <code>POST</code>, <code>PUT</code>, <code>DELETE</code>, …)</li>
<li>Caching</li>
<li>Redirection and forwarding</li>
<li>Security (encryption and authentication)</li>
</ul>
<p>These are all critical factors on building resilient services. But that is not all. The web is built out of lots of tiny specs, hence it’s been able to evolve easily, without getting bogged down in "standards wars". Developers are able to draw upon 3rd party toolkits that implement these diverse specs and instantly have both client and server technology at their fingertips.</p>
<p>What’s important to realize is that REST, however ubiquitous, is not a standard, <em>per se</em>, but an approach, a style, a set of <em>constraints</em> on your architecture that can help you build web-scale systems. In this tutorial we will use the Spring portfolio to build a RESTful service while leveraging the stackless features of REST.</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> payroll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Objects;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Employee</span> {</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="meta">@Id</span> <span class="meta">@GeneratedValue</span> Long id;</span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line">  <span class="keyword">private</span> String role;</span><br><span class="line"></span><br><span class="line">  Employee() {}</span><br><span class="line"></span><br><span class="line">  Employee(String name, String role) {</span><br><span class="line"></span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">    <span class="built_in">this</span>.role = role;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> Long <span class="title function_">getId</span><span class="params">()</span> {</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.id;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> {</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.name;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getRole</span><span class="params">()</span> {</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.role;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(Long id)</span> {</span><br><span class="line">    <span class="built_in">this</span>.id = id;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> {</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setRole</span><span class="params">(String role)</span> {</span><br><span class="line">    <span class="built_in">this</span>.role = role;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object o)</span> {</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span> == o)</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span> (!(o <span class="keyword">instanceof</span> Employee))</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="type">Employee</span> <span class="variable">employee</span> <span class="operator">=</span> (Employee) o;</span><br><span class="line">    <span class="keyword">return</span> Objects.equals(<span class="built_in">this</span>.id, employee.id) &amp;&amp; Objects.equals(<span class="built_in">this</span>.name, employee.name)</span><br><span class="line">        &amp;&amp; Objects.equals(<span class="built_in">this</span>.role, employee.role);</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span> {</span><br><span class="line">    <span class="keyword">return</span> Objects.hash(<span class="built_in">this</span>.id, <span class="built_in">this</span>.name, <span class="built_in">this</span>.role);</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> {</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Employee{"</span> + <span class="string">"id="</span> + <span class="built_in">this</span>.id + <span class="string">", name='"</span> + <span class="built_in">this</span>.name + <span class="string">'\''</span> + <span class="string">", role='"</span> + <span class="built_in">this</span>.role + <span class="string">'\''</span> + <span class="string">'}'</span>;</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Spring JPA doc: <a target="_blank" rel="noopener external nofollow noreferrer" href="https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#preface">Spring Data JPA - Reference Documentation</a></p>
<p>Spring Data JPA repositories are interfaces with methods supporting creating, reading, updating, and deleting records against a back end data store. Some repositories also support data paging, and sorting, where appropriate. Spring Data synthesizes implementations based on conventions found in the naming of the methods in the interface.</p>
<p>Spring makes accessing data easy. By simply declaring the following <code>EmployeeRepository</code> interface we automatically will be able to</p>
<ul>
<li>Create new Employees</li>
<li>Update existing ones</li>
<li>Delete Employees</li>
<li>Find Employees (one, all, or search by simple or complex properties)</li>
</ul>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> payroll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">EmployeeRepository</span> <span class="keyword">extends</span> <span class="title class_">JpaRepository</span>&lt;Employee, Long&gt; {</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>To get all this free functionality, all we had to do was declare an interface which extends Spring Data JPA’s <code>JpaRepository</code>, specifying the domain type as <code>Employee</code> and the id type as <code>Long</code>.</p>
<p><code>@SpringBootApplication</code> is a meta-annotation that pulls in <strong>component scanning</strong>, <strong>autoconfiguration</strong>, and <strong>property support</strong>. We won’t dive into the details of Spring Boot in this tutorial, but in essence, it will fire up a servlet container and serve up our service.</p>
<h2 id="spring-core">Spring Core</h2>
<h3 id="dependency-injection">Dependency Injection</h3>
<p>Spring IoC is the mechanism to achieve loose-coupling between Objects dependencies. To achieve loose coupling and dynamic binding of the objects at runtime, objects dependencies are injected by other assembler objects. Spring IoC container is the program that <strong>injects</strong> dependencies into an object and make it ready for our use. Spring IoC container provides us different ways to decouple the object dependencies.</p>
<p><code>BeanFactory</code> is the root interface of Spring IoC container. <code>ApplicationContext</code> is the child interface of <code>BeanFactory</code> interface that provide Spring AOP features, i18n etc. Some of the useful child-interfaces of <code>ApplicationContext</code> are <code>ConfigurableApplicationContext</code> and <code>WebApplicationContext</code>. Spring Framework provides a number of useful ApplicationContext implementation classes that we can use to get the spring context and then the Spring Bean.</p>
<ul>
<li><strong>AnnotationConfigApplicationContext</strong>: If we are using Spring in standalone java applications and using annotations for Configuration, then we can use this to initialize the container and get the bean objects.</li>
<li><strong>ClassPathXmlApplicationContext</strong>: If we have spring bean configuration xml file in standalone application, then we can use this class to load the file and get the container object.</li>
</ul>
<p>Spring Bean is nothing special, any object in the Spring framework that we initialize through Spring container is called Spring Bean. Any normal Java POJO class can be a Spring Bean if it’s configured to be initialized via container by providing configuration metadata information.</p>
<p>There are five scopes defined for Spring Beans.</p>
<ol type="1">
<li><strong>singleton</strong> – Only one instance of the bean will be created for each container. This is the default scope for the spring beans. While using this scope, make sure bean doesn’t have shared instance variables otherwise it might lead to data inconsistency issues.</li>
<li><strong>prototype</strong> – A new instance will be created every time the bean is requested.</li>
<li><strong>request</strong> – This is same as prototype scope, however it’s meant to be used for web applications. A new instance of the bean will be created for each HTTP request.</li>
<li><strong>session</strong> – A new bean will be created for each HTTP session by the container.</li>
<li><strong>global-session</strong> – This is used to create global session beans for Portlet applications.</li>
</ol>
<p>Spring Framework provides three ways to configure beans to be used in the application.</p>
<p>1 Annotation Based Configuration – By using <span class="citation" data-cites="Service">[@Service]</span> or <span class="citation" data-cites="Component">[@Component]</span> annotations. Scope details can be provided with <span class="citation" data-cites="Scope">[@Scope]</span> annotation. 2 XML Based Configuration – By creating Spring Configuration XML file to configure the beans. If you are using Spring MVC framework, the xml based configuration can be loaded automatically by writing some boiler plate code in web.xml file. 3 Java Based Configuration – Starting from Spring 3.0, we can configure Spring beans using java programs. Some important annotations used for java based configuration are <span class="citation" data-cites="Configuration">[@Configuration]</span>, <span class="citation" data-cites="ComponentScan">[@ComponentScan]</span> and <span class="citation" data-cites="Bean">[@Bean]</span>.</p>
<p>Dependency Injection</p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://dzone.com/articles/dependency-injection-in-spring">Dependency Injection in Spring - DZone Java</a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://spring.io/">Spring</a> is a Dependency Injection (DI) framework used in a majority of enterprise Java applications, including web services, microservices, and data-driven systems. The power of Spring stems from its ability to perform a vast array of tasks — such as DI, database abstraction, and web-endpoint abstraction— with minimal code.</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Car</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">private</span> Engine engine;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Car</span><span class="params">(Engine engine)</span>{</span><br><span class="line">        <span class="built_in">this</span>.engine=engine;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">start</span><span class="params">()</span></span><br><span class="line">    {</span><br><span class="line">        engine.turnOn();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>By adding the Engine constructor argument, we have changed the decision of which Engine implementation to use from the Car class itself — which originally decided on a CombustionEngine — to the client that instantiates the Car class. This reversal of the decision process is called the IoC principle. Instead of the Car class itself controlling which Engine implementation is used, now the client controls which implementation is used.</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">CombustionEngine</span> <span class="variable">combustionEngine</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CombustionEngine</span>(); </span><br><span class="line"><span class="type">Car</span> <span class="variable">combustionCar</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Car</span>(combustionEngine); </span><br><span class="line">combustionCar.start(); </span><br><span class="line"><span class="type">ElectricEngine</span> <span class="variable">electricEngine</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ElectricEngine</span>(); </span><br><span class="line"><span class="type">Car</span> <span class="variable">electricCar</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Car</span>(electricEngine);</span><br><span class="line">electricCar.start();</span><br></pre></td></tr></tbody></table></figure>
<p>An additional benefit of IoC is that it also makes testing the Car class much easier. Since the Engine implementation can be supplied by the client, we can supply a mock Engine object within our testing framework that can be used to ensure that specific methods are called on the Engine implementation when actions on the Car are performed.</p>
<p>In short, originally, we instantiated the Car object first and then instantiated the Engine object; but, using IoC, we first instantiate the Engine object and then the Car object. Therefore, we have created a dependency in the construction process. This dependency differs from the compile-time dependency that the Car class has on the Engine interface, though. Instead, we have introduced a run-time dependency. Before a Car object can be instantiated at run-time, an Engine object must be instantiated first.</p>
<p>For example, if the CombustionEngine had other dependencies, we would be required to first satisfy the dependencies of the CombustionEngine before we could instantiate a CombustionEngine object to be passed to our Car constructor during instantiation of the Car object:</p>
<p>This complexity would continue to grow as we continue to introduce more dependencies. To resolve this complication, we need to abstract the creation process for an object based on its dependency tree. This process is what constitutes a DI framework.</p>
<p>In general, we can reduce this process into three parts:</p>
<ol type="1">
<li><p>Declare what dependencies are required for a given object.</p></li>
<li><p>Register classes that are eligible to create these dependent objects.</p></li>
<li><p>Provide a mechanism for creating objects, using the information in (1) and (2).</p></li>
</ol>
<p>This process is recursive, though. Since we declared the CombustionEngine class to be eligible as a dependency, we would need to know how to create an object of the CombustionEngine class. This necessitates that we introspect the CombustionEngine constructor — as we did in (1) — which tells us that in order to create a CombustionEngine object, we require Camshaft and Crankshaft objects. Thus, we would now require that the Camshaft and Crankshaft classes be declared as eligible to be used as dependencies before we could create a Car object.</p>
<p>Lastly, (3) we take the previous two requirements and puts them into action. In practice, this means that when an object is requested, such as a Car object, we must walk the dependency tree and check that there is at least one eligible class for all dependencies. For example, declaring the CombustionEngine class as eligible satisfies the Engine node requirement. If such a dependency exists, we instantiate the dependency and then move to the next node. If there is more than one class that satisfies a required dependency, then we must explicitly state which of the possibilities should be selected.</p>
<img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/reading-notes/cqNotes/Java/cq_springboot/image-20210830120630600.png" class="">
<p>In the case of Spring, the framework centers around the ApplicationContext interface. This interface represents a context that is responsible for implementing the three DI responsibilities outlined in the previous section. Thus, we register eligible classes with the ApplicationContext through either Java-based or XML-based configurations and request the creation of objects, called beans, from the ApplicationContext . The ApplicationContext then builds a dependency tree and traverses it to create the desired bean.</p>
<p>The logic contained in the ApplicationContext is often referred to as the Spring Container.In general, a Spring application can have more than one ApplicationContext , and each ApplicationContext can have separate configurations.</p>
<p>Spring provides two Java-based mechanisms for configurations: 1. Basic and 2. automated.</p>
<h3 id="basic-java-based-configuration">Basic Java-Based Configuration</h3>
<p>At its core, two main annotations make up this process:</p>
<ol type="1">
<li><p><span class="citation" data-cites="Configuration">[@Configuration]</span> : Defines a configuration class.</p></li>
<li><p><span class="citation" data-cites="Bean">[@Bean]</span> : Declares that the return value of the annotated method should be used as a dependency.</p></li>
</ol>
<p>For example, given the Car , CombustionEngine , Camshaft , and Crankshaft classes we previously defined, we can create a configuration that resembles the following:</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnnotationConfig</span> {</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span> </span><br><span class="line"><span class="keyword">public</span> Car <span class="title function_">car</span><span class="params">(Engine engine)</span> { <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Car</span>(engine); }</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span> </span><br><span class="line"><span class="keyword">public</span> Engine <span class="title function_">engine</span><span class="params">(Camshaft camshaft, Crankshaft crankshaft)</span> { <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">CombustionEngine</span>(camshaft, crankshaft); }</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span> </span><br><span class="line"><span class="keyword">public</span> Camshaft <span class="title function_">camshaft</span><span class="params">()</span> { <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Camshaft</span>(); }</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span> </span><br><span class="line"><span class="keyword">public</span> Crankshaft <span class="title function_">crankshaft</span><span class="params">()</span> { <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Crankshaft</span>(); }</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(AnnotationConfig.class); <span class="type">Car</span> <span class="variable">car</span> <span class="operator">=</span> context.getBean(Car.class); car.start();</span><br></pre></td></tr></tbody></table></figure>
<p>While the combination of the <span class="citation" data-cites="Configuration">[@Configuration]</span> and <span class="citation" data-cites="Bean">[@Bean]</span> annotations provide enough information to Spring to perform dependency injection, we are still forced to manually define every bean that will be injected and explicitly state their dependencies—twice in fact: Once in the <span class="citation" data-cites="Bean">[@Bean]</span> method signature and again in the constructor of the bean. To reduce the overhead necessary for configuring the DI framework, Spring provides annotations that automatically introspect eligible classes.</p>
<h3 id="automated-java-based-configuration">Automated Java-Based Configuration</h3>
<p>there are three foundational annotations:</p>
<ol type="1">
<li><p><span class="citation" data-cites="Component">[@Component]</span> : Registers as a class as being managed by Spring.</p></li>
<li><p><span class="citation" data-cites="Autowired">[@Autowired]</span> : Instructs Spring that a dependency should be injected.</p></li>
<li><p><span class="citation" data-cites="ComponentScan">[@ComponentScan]</span> : Instructs Spring where to look for classes annotated with <span class="citation" data-cites="Component">[@Component]</span></p></li>
</ol>
<p>Although the <span class="citation" data-cites="Component">[@Component]</span> annotation does mark a class as eligible to be used as a dependency, it brings with it additional features. In a similar manner, we have to instruct Spring that — even though no Car object is being injected into another object as a dependency — that the Car class can be managed by Spring. Thus, we will also annotate our Car class with <span class="citation" data-cites="Component">[@Component]</span> .</p>
<p>The second annotation, <span class="citation" data-cites="Autowired">[@Autowired]</span> , is used to instruct Spring that we intend to have a dependency injected — termed autowired in the Spring lexicon — at the annotated location. For example, in the Car constructor, we expect to have an Engine object injected, and therefore, we will annotate the Car constructor with <span class="citation" data-cites="Autowired">[@Autowired]</span> . Applying the <span class="citation" data-cites="Component">[@Component]</span> and <span class="citation" data-cites="Autowired">[@Autowired]</span> annotations to our Car class, we end up with the following definition for Car :</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Car</span> {</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> Engine engine;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span> </span><br><span class="line"><span class="keyword">public</span> <span class="title function_">Car</span><span class="params">(Engine engine)</span> { <span class="built_in">this</span>.engine = engine; }</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">start</span><span class="params">()</span> { engine.turnOn(); }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>With our classes properly annotated, the last step is to create a <span class="citation" data-cites="Configuration">[@Configuration]</span> class to instruct Spring how to autowire our application. In the case of a basic Java-based configuration, we explicitly instructed Spring how to create each bean using the <span class="citation" data-cites="Bean">[@Bean]</span> annotation, but in the automated approach, we have already provided sufficient information — through the <span class="citation" data-cites="Component">[@Component]</span> and <span class="citation" data-cites="Autowired">[@Autowired]</span> annotations — on how to create all of the required beans. The only information missing is where Spring should look to find our <span class="citation" data-cites="Component">[@Component]</span> classes.</p>
<p>Java applications can contain a nearly-endless number of classes in any arbitrary package structure. Searching the entire classpath for classes annotated with <span class="citation" data-cites="Component">[@Component]</span> would be an infeasible task for Spring, so instead, Spring requires that we tell it explicitly where to search for eligible classes annotated with <span class="citation" data-cites="Component">[@Component]</span> . To do this, we use the <span class="citation" data-cites="ComponentScan">[@ComponentScan]</span> annotation and apply it to a class annotated with <span class="citation" data-cites="Configuration">[@Configuration]</span> .</p>
<p>The <span class="citation" data-cites="ComponentScan">[@ComponentScan]</span> annotation includes a parameter, basePackages , that allows us to specify a package name as a String that Spring will search, recursively, to find <span class="citation" data-cites="Component">[@Component]</span> classes. I</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="comment">//@ComponentScan(basePackages = "exampleDI.dzoneExample.autoAnnotation")</span></span><br><span class="line"><span class="meta">@ComponentScan("exampleDI.dzoneExample.autoAnnotation")</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AutoAnnotationConstructorInjectionConfig</span></span><br><span class="line">{</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>The <span class="citation" data-cites="ComponentScan">[@ComponentScan]</span> annotation also includes a basePackageClasses parameter that can be used instead of the basePackages parameter. The basePackageClasses allows us to specify a class, which Spring will assume is contained in the base package that should be searched. For example, if we provide Car.class as an argument, then Spring will consider the package containing the Car class as the basePackage to be searched.</p>
<p>This approach is useful, especially during development, where package names and locations may change and automatically updating a String -based package name within in the <span class="citation" data-cites="ComponentScan">[@ComponentScan]</span> annotation could be difficult. Using the basePackageClasses approach, we obtain the following <span class="citation" data-cites="Configuration">[@Configuration]</span> class:</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span> </span><br><span class="line"><span class="meta">@ComponentScan(basePackageClasses = Car.class)</span> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AutomatedAnnotationConfig</span> {}</span><br></pre></td></tr></tbody></table></figure>
<p>It is important to note that both the basePackages and basePackageClasses parameters can accept more than one value using the array notation for an annotation parameter. For example, both of the following <span class="citation" data-cites="ComponentScan">[@ComponentScan]</span> definitions are valid:</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ComponentScan(basePackages = {"a.b.c", "x.y.z"})</span> </span><br><span class="line"><span class="meta">@ComponentScan(basePackageClasses = {Abc.class, Xyz.class})</span></span><br></pre></td></tr></tbody></table></figure>
<p>Since we have annotated two classes that implement the Engine interface with <span class="citation" data-cites="Component">[@Component]</span> —namely, CombustionEngine and ElectricEngine —Spring is now unable to determine which of the two classes should be used to satisfy the Engine dependency when instantiating a Car object. To resolve this issue, we have to explicitly instruct Spring which of the two beans to use.</p>
<p>One approach is to name our component and use the <span class="citation" data-cites="Qualifier">[@Qualifier]</span> annotation where the <span class="citation" data-cites="Autowired">[@Autowired]</span> annotation is applied. As the name implies, the <span class="citation" data-cites="Qualifier">[@Qualifier]</span> annotation qualifies the bean that the is autowired, reducing the number of beans that meet the desired criteria—eventually to one.</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="meta">@Component("defaultEngine")</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CombustionEngine</span> <span class="keyword">implements</span> <span class="title class_">Engine</span> { ... }</span><br></pre></td></tr></tbody></table></figure>
<p>Then we can add a <span class="citation" data-cites="Qualifier">[@Qualifier]</span> annotation—whose name matches our desired component name ( default )—where our Engine object is autowired in the Car constructor:</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Car</span> {</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span> </span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">Car</span><span class="params">(<span class="meta">@Qualifier("defaultEngine")</span> Engine engine)</span> { <span class="built_in">this</span>.engine = engine; }</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...existing implementation unchanged...</span></span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Cyclic Dependencies</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Foo</span>{</span><br><span class="line">  <span class="keyword">private</span> Bar bar;</span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">Foo</span><span class="params">(Bar bar)</span></span><br><span class="line">  {</span><br><span class="line">    <span class="built_in">this</span>.bar = bar;</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Bar</span></span><br><span class="line">{</span><br><span class="line">  <span class="keyword">private</span> Foo foo;</span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">Bar</span><span class="params">(Foo foo)</span>{</span><br><span class="line">    <span class="built_in">this</span>.foo=foo;</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"><span class="comment">//org.springframework.beans.factory.BeanCurrentlyInCreationException: Error creating bean with name 'bar': Requested bean is currently in creation: Is there an unresolvable circular reference?</span></span><br></pre></td></tr></tbody></table></figure>
<p>One of the simplest solutions to this problem is to use the <span class="citation" data-cites="Lazy">[@Lazy]</span> annotation on one of the classes and at the point of injection. This instructs Spring to defer the initialization of the annotated bean and the annotated <span class="citation" data-cites="Autowired">[@Autowired]</span> location. This allows one of the beans to be successfully initialized, thus breaking the circular dependency chain.</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span> </span><br><span class="line"><span class="meta">@Lazy</span> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Bar</span> {</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span> </span><br><span class="line"><span class="keyword">public</span> <span class="title function_">Bar</span><span class="params">(Foo foo)</span> {}</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>Scopes</strong> defines the scope of the bean object (singleton, prototype, etc). Spring supports five scopes, three of them are available only with the web apps.</p>
<p>The default scope is “singleton”, while the “prototype” scope will create a new object every time we instantiate an object. <a target="_blank" rel="noopener external nofollow noreferrer" href="https://stackoverflow.com/questions/2365677/creating-lazily-initialized-spring-beans-using-annotation-based-configuration">With prototype scope, beans already are lazy instantiated</a><em>. So, lazy instantiation is only useful when the scope is singleton.</em></p>
<p><strong>Lifecycle</strong> of the bean is as the following:</p>
<p><em>Bean Instantiated → Dependencies Injected → Internal Processing → Custom Init and destroy method (hooks) → Bean is ready for use.</em></p>
<script type="text&#x2F;javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.7.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.7.0/dist/mindmap.min.css"></article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/reading-notes/tags/software-dev/">software_dev</a><a class="post-meta__tags" href="/reading-notes/tags/spring/">spring</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/reading-notes/cqNotes/Java/cq_junit/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/reading-notes/default_cover/sunflowers-7112463_1280.jpg" onerror="onerror=null;src='/reading-notes/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">cq_junit</div></div></a></div><div class="next-post pull-right"><a href="/reading-notes/cqNotes/Python/pytu_python%20intro_202011/"><img class="next-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/reading-notes/default_cover/circles-5444818_1280.png" onerror="onerror=null;src='/reading-notes/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Python Common and Gotchas</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/reading-notes/cqNotes/SoftwareDev/SpringInAction/spring-in-action-notes-07/" title="Spring In Action Notes (7)"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/reading-notes/default_cover/sunflowers-7112463_1280.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-01</div><div class="title">Spring In Action Notes (7)</div></div></a></div><div><a href="/reading-notes/cqNotes/SoftwareDev/SpringInAction/spring-in-action-notes-06/" title="Spring In Action Notes (6)"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/reading-notes/default_cover/gamer-6022003.svg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-29</div><div class="title">Spring In Action Notes (6)</div></div></a></div><div><a href="/reading-notes/cqNotes/SoftwareDev/SpringInAction/spring-in-action-notes-04/" title="Spring In Action Notes (4)"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/reading-notes/default_cover/abstract-1264071.svg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-28</div><div class="title">Spring In Action Notes (4)</div></div></a></div><div><a href="/reading-notes/cqNotes/SoftwareDev/SpringInAction/spring-in-action-notes-03/" title="Spring In Action Notes (3)"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/reading-notes/default_cover/sea-view-7219685_1280.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-28</div><div class="title">Spring In Action Notes (3)</div></div></a></div><div><a href="/reading-notes/cqNotes/SoftwareDev/SpringInAction/spring-in-action-notes-02/" title="Spring In Action Notes (2)"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/reading-notes/default_cover/trees-6207925_1920.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-27</div><div class="title">Spring In Action Notes (2)</div></div></a></div><div><a href="/reading-notes/cqNotes/SoftwareDev/SpringInAction/spring-in-action-notes-01/" title="Spring In Action Reading Notes (1)"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/reading-notes/default_cover/neural-network-3816319.svg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-26</div><div class="title">Spring In Action Reading Notes (1)</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#spring-boot-rest-hello-world"><span class="toc-number">1.</span> <span class="toc-text">Spring Boot REST Hello World</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rest-api"><span class="toc-number">2.</span> <span class="toc-text">REST API</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#create-a-resource-representation-class"><span class="toc-number">2.1.</span> <span class="toc-text">Create a Resource Representation Class</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#create-a-resource-controller"><span class="toc-number">2.2.</span> <span class="toc-text">Create a Resource Controller</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bild-an-executable-jar"><span class="toc-number">2.3.</span> <span class="toc-text">Bild an executable JAR</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#test-the-service"><span class="toc-number">2.4.</span> <span class="toc-text">Test the service</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#springboot-rest-example-different-layers"><span class="toc-number">3.</span> <span class="toc-text">SpringBoot REST Example Different Layers</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#building-rest-services-with-spring"><span class="toc-number">4.</span> <span class="toc-text">Building REST services with Spring</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#spring-core"><span class="toc-number">5.</span> <span class="toc-text">Spring Core</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dependency-injection"><span class="toc-number">5.1.</span> <span class="toc-text">Dependency Injection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#basic-java-based-configuration"><span class="toc-number">5.2.</span> <span class="toc-text">Basic Java-Based Configuration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#automated-java-based-configuration"><span class="toc-number">5.3.</span> <span class="toc-text">Automated Java-Based Configuration</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="Increase font size"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="Decrease font size"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/reading-notes/js/utils.js"></script><script src="/reading-notes/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/reading-notes/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      false && mermaid.init()
    })
  }
}</script></div></div><!-- hexo injector body_end start --><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><!-- hexo injector body_end end --></body></html>